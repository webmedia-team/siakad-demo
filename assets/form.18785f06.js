var _=Object.defineProperty;var C=(r,a,s)=>a in r?_(r,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[a]=s;var v=(r,a,s)=>(C(r,typeof a!="symbol"?a+"":a,s),s);import{C as P,c as e,g as j,p as N,u as n}from"./index.d57021e8.js";import{m as w}from"./map-actions.609b7ae0.js";const u="portal/announcements",[l,i]=n(""),[o,c]=n(""),[F,h]=n(""),[x,p]=n(""),[b,f]=n(""),[y,g]=n("");class S extends P{render(){var a,s,m,d;return e("div",{className:"intro-y"},e("div",{className:"container"},e("div",{className:"row"},e("div",{className:"col-12"},e("div",{className:"page-title-box d-sm-flex align-items-center justify-content-between"},e("h4",{className:"mb-sm-0 title"},(s=(a=this.meta)==null?void 0:a.title)!=null?s:"Untitled Page"),e("div",{className:"page-title-right"},e("ol",{className:"breadcrumb"},e("li",{className:"breadcrumb-item"},e("router-name",{name:"apps.dashboard"},"Dashboard")),e("li",{className:"breadcrumb-item"},"Portal"),e("li",{className:"breadcrumb-item"},e("router-name",{name:"apps.portal.announcements"},"Pengumuman")),e("li",{className:"breadcrumb-item active title"},(d=(m=this.meta)==null?void 0:m.title)!=null?d:"Untitled Page")))))),e("div",{className:"card intro-y"},e("div",{className:"card-body"},e("form",{onsubmit:this.submit},e("div",{className:"mb-3"},e("div",{className:"row"},e("div",{className:"col-md-6 col-sm-6 col-12"},e("label",{for:"type_intended_for",className:"form-label"},"Tipe Diperuntukan Untuk"),e("select",{name:"type_intended_for",id:"type_intended_for",className:"form-control js-choices",onChange:t=>{i(t.target.value),this.changeTypeIntendedFor()}},e("option",{value:""},"Pilih Tipe Diperuntukan Untuk"),e("option",{value:"major",selected:l=="major"},"Jurusan"),e("option",{value:"study_program",selected:l=="study_program"},"Program Studi"),e("option",{value:"user",selected:l=="user"},"User"),e("option",{value:"role",selected:l=="role"},"Role"))),e("div",{className:"col-md-6 col-sm-6 col-12"},e("label",{htmlFor:"intended_for",className:"form-label"},"Diperuntukan Untuk (Jurusan / Prodi / User / Role)"),e("select",{name:"intended_for",id:"intended_for",className:"form-control js-choices",onChange:t=>c(t.target.value)})))),e("div",{className:"mb-3"},e("div",{className:"row"},e("div",{className:"col-md-12 col-sm-12 col-12"},e("label",{htmlFor:"title",className:"form-label"},"Judul ",e("i",{className:"text-danger"},"*")),e("input",{type:"text",className:"form-control",name:"title",placeholder:"Judul",autoComplete:"off",onKeyUp:t=>h(t.target.value),value:F})))),e("div",{className:"mb-3"},e("div",{className:"row"},e("div",{className:"col-md-12 col-sm-12 col-12"},e("label",{htmlFor:"message",className:"form-label"},"Pesan ",e("i",{className:"text-danger"},"*")),e("textarea",{name:"message",id:"message",cols:"30",rows:"3",className:"form-control",autoComplete:"off",placeholder:"Pesan",onKeyUp:t=>p(t.target.value)},x)))),e("div",{className:"mb-3"},e("div",{className:"row"},e("div",{className:"col-md-6 col-sm-6 col-12"},e("label",{htmlFor:"is_priority",className:"form-label"},"Prioritas? ",e("i",{className:"text-danger"},"*")),e("select",{name:"is_priority",id:"is_priority",className:"form-control js-choices",onChange:t=>f(t.target.value)},e("option",{value:""},"Pilih Prioritas"),e("option",{value:"true",selected:b=="true"},"Ya"),e("option",{value:"false",selected:b=="false"},"Tidak"))),e("div",{className:"col-md-6 col-sm-6 col-12"},e("label",{htmlFor:"is_active",className:"form-label"},"Status ",e("i",{className:"text-danger"},"*")),e("select",{name:"is_active",id:"isActive",className:"form-control js-choices",onChange:t=>g(t.target.value)},e("option",{value:""},"Pilih Status"),e("option",{value:"true",selected:y=="true"},"Aktif"),e("option",{value:"false",selected:y=="false"},"Tidak Aktif"))))),e("div",{className:"mb-3"},e("div",{className:"row"},e("div",{className:"col-sm-12 col-md-12 col-12"},e("label",{htmlFor:"image",className:"form-label"},"Thumbnail"),e("br",null),e("input",{type:"file",name:"image",id:"image",className:"filepond form-control"})))),e("div",{className:"mb-3"},e("div",{className:"row"},e("div",{className:"col-sm-12 col-md-12 col-12"},e("label",{htmlFor:"document",className:"form-label"},"Lampiran"),e("br",null),e("input",{type:"file",name:"document",id:"document",className:"filepond form-control"})))),e("div",{className:"card-footer text-end"},e("router-name",{className:"btn btn-dark mx-1",name:"apps.portal.announcements"},"Kembali"),e("button",{className:"btn btn-primary",type:"submit","data-form-loading":!0},e("i",{className:"bx bx-save"})," Simpan")))))))}componentDidMount(){this.choices=$(".js-choices"),this.fetchDataIntendedFor()}componentWillMount(){i(""),c(""),h(""),p(""),f(""),g(""),this.$router.params.id&&this.getData()}async getData(){const{data:a}=await j(`${u}/${this.$router.params.id}`,{hideSuccessNotification:!0});this.setState(()=>{var s,m,d,t;(s=a.announcement)!=null&&s.major_id?(i("major"),c(a.announcement.major_id)):(m=a.announcement)!=null&&m.study_program_id?(i("study_program"),c(a.announcement.study_program_id)):(d=a.announcement)!=null&&d.user_id?(i("user"),c(a.announcement.user_id)):(t=a.announcement)!=null&&t.role_id?(i("role"),c(a.announcement.role_id)):(i(""),c("")),h(a.announcement.title),p(a.announcement.message),f(a.announcement.is_priority.toString()),g(a.announcement.is_active.toString())})}async submit(a){a.preventDefault();let s;this.$router.params.id?s=await N(`${u}/${this.$router.params.id}`,a.target):s=await N(u,a.target),s.status==200&&this.$router.pushState("/apps/portal/announcements")}changeTypeIntendedFor(){this.fetchDataIntendedFor()}async fetchDataIntendedFor(){let a;l=="major"?(a=await this.getMajors("is_active=true"),this.clearChoices(),a.status==200&&a.data.majors.length>0&&a.data.majors.forEach(s=>{this.choices[1].choices.setChoices([{value:s.id,label:s.name,selected:o!=null&&o==s.id}])})):l=="study_program"?(a=await this.getStudyPrograms(),this.clearChoices(),a.status==200&&a.data.studyPrograms.length>0&&a.data.studyPrograms.forEach(s=>{this.choices[1].choices.setChoices([{value:s.id,label:s.education_level!=null?s.education_level.code+" - "+s.name:s.name,selected:o!=null&&o==s.id}])})):l=="user"?(a=await this.getUsers(),this.clearChoices(),a.status==200&&a.data.users.length>0&&a.data.users.forEach(s=>{this.choices[1].choices.setChoices([{value:s.hashid,label:s.name,selected:o!=null&&o==s.id}])})):l=="role"?(a=await this.getRoles(),this.clearChoices(),a.status==200&&a.data.roles.length>0&&a.data.roles.forEach(s=>{this.choices[1].choices.setChoices([{value:s.hashid,label:s.name,selected:o!=null&&o==s.id}])})):this.clearChoices()}clearChoices(){this.choices[1].choices!=null&&(this.choices[1].choices.clearChoices(),this.choices[1].choices.clearStore(),this.choices[1].choices.clearInput())}}v(S,"defaultProps",{...w(["getMajors","getStudyPrograms","getUsers","getRoles"]),choices:null});export{S as default};
