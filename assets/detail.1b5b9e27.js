var L=Object.defineProperty;var B=(n,a,s)=>a in n?L(n,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[a]=s;var b=(n,a,s)=>(B(n,typeof a!="symbol"?a+"":a,s),s);import{A,a as f,C as w,c as e,g as c,r as p,h,d as D,p as v,u}from"./index.d57021e8.js";import{i as g}from"./datatable.4b22066f.js";import{B as y}from"./button.d257158a.js";/* empty css                 */import"./jquery.4c77f39d.js";const I=(n,a,s)=>({url:A+"/lecture/activities/"+n+"/members",table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,id:"code",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender:(t,i,r,l)=>`
                  <div class="form-check">
                      <input class="form-check-input dt-checkbox" type="checkbox" value="${r.id}">
                  </div>`},{title:"No",data:"id",name:"id",searchable:!1,orderable:!1,width:"5%",mRender:(t,i,r,l)=>l.row+l.settings._iDisplayStart+1},{title:"NIM",data:"student.nim",name:"student.nim",mRender:(t,i,r)=>{var l,o;return`${(o=(l=r.student)==null?void 0:l.nim)!=null?o:"-"}`}},{title:"Nama Mahasiswa",data:"student.name",name:"student.name",mRender:(t,i,r)=>`${t!=null?t:"-"}`},{title:"Angkatan",data:"student.academic_period.academic_year_id",name:"student.academic_period.academic_year_id",mRender:(t,i,r)=>`${t!=null?t:"-"}`},{title:"Peran",data:"role_type",name:"role_type"},{title:"",data:"id",name:"id",searchable:!1,orderable:!1,sClass:"text-center nowrap",mRender:(t,i,r,l)=>{var o="";return r.feeder_id==null&&(f().includes("update-activities")&&(o+=`<button type="button" class="btn btn-outline-primary btn-sm mx-1" data-toggle="edit-data-member" data-id="${t}"><i class="bx bx-edit-alt"></i></button>`),f().includes("delete-activities")&&(o+=`<button type="button" class="btn btn-outline-danger btn-sm mx-1" data-toggle="delete-data-member" data-id="${t}"><i class="bx bx-trash"></i></button>`)),o}}],callback:()=>{$('button[data-toggle="edit-data-member"]').unbind().on("click",function(t){t.preventDefault(),a($(this).data("id"))}),$('button[data-toggle="delete-data-member"]').unbind().on("click",function(t){t.preventDefault(),s($(this).data("id"))})},options:{}}),P=(n,a,s,t)=>({url:A+"/lecture/activities/"+n+`/supervisors?role_type=${t}`,table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,id:"code",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender:(i,r,l,o)=>`
                  <div class="form-check">
                      <input class="form-check-input dt-checkbox" type="checkbox" value="${l.id}">
                  </div>`},{title:"No",data:"id",name:"id",searchable:!1,orderable:!1,width:"5%",mRender:(i,r,l,o)=>o.row+o.settings._iDisplayStart+1},{title:"NIDN",data:"employee.nidn",name:"employee.nidn",mRender:(i,r,l)=>`${i!=null?i:""}`},{title:"Nama Dosen",data:"employee.name",name:"employee.name",mRender:(i,r,l)=>{var o,m,k,_;return`${(m=(o=l.employee)==null?void 0:o.front_title)!=null?m:""} ${i!=null?i:""} ${(_=(k=l.employee)==null?void 0:k.back_title)!=null?_:""}`}},{title:`Dosen ${t=="0"?"Pembimbing":"Penguji"} Ke`,data:"number",name:"number"},{title:"Kategori Aktivitas",data:"activity_category.name",name:"activity_category.name",mRender:function(i,r,l){return l.activity_category_id+" - "+i}},{title:"",data:"id",name:"id",searchable:!1,orderable:!1,sClass:"text-center nowrap",mRender:(i,r,l,o)=>{var m="";return l.feeder_id==null&&(f().includes("update-activities")&&(m+=`<button type="button" class="btn btn-outline-primary btn-sm mx-1" data-toggle="edit-data-supervisor" data-id="${i}" data-role-type="${t}"><i class="bx bx-edit-alt"></i></button>`),f().includes("delete-activities")&&(m+=`<button type="button" class="btn btn-outline-danger btn-sm mx-1" data-toggle="delete-data-supervisor" data-id="${i}"><i class="bx bx-trash"></i></button>`)),m}}],callback:()=>{$('button[data-toggle="edit-data-supervisor"]').unbind().on("click",function(i){i.preventDefault(),a($(this).data("id"),$(this).data("role-type"))}),$('button[data-toggle="delete-data-supervisor"]').unbind().on("click",function(i){i.preventDefault(),s($(this).data("id"))})},options:{}});class M extends w{render(){var a;return e("div",{className:"modal fade",id:"member-modal",role:"dialog"},e("div",{className:"modal-dialog",role:"document"},e("div",{className:"modal-content"},e("form",{onsubmit:this.props.onsubmit},e("div",{className:"modal-header bg-light pb-2"},e("h5",{className:"modal-title"},this.props.title)),e("div",{className:"modal-body"},e("div",{className:"mb-3"},e("label",{htmlFor:"student"},"Peserta ",e("span",{className:"text-danger"},"*")),e("select",{name:"student_id",id:"student",className:"form-control js-choices"},e("option",{value:""},"Pilih"),(a=this.props.students)==null?void 0:a.map(s=>e("option",{value:s.id},s.nim," - ",s.name)))),e("div",{className:"mb-3"},e("label",{htmlFor:"role"},"Peran ",e("span",{className:"text-danger"},"*")),e("select",{name:"role_type",id:"role",className:"form-control js-choices"},e("option",{value:""},"Pilih"),e("option",{value:"1"},"Ketua"),e("option",{value:"2"},"Anggota"),e("option",{value:"3"},"Personal")))),e("div",{className:"modal-footer"},e("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),e("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},e("i",{className:"bx bx-save"})," Simpan"))))))}}b(M,"defaultProps",{onsubmit:null,title:"Untitled Modal",students:null});class R extends w{render(){var a,s;return e("div",{className:"modal fade",id:"supervisor-modal",role:"dialog"},e("div",{className:"modal-dialog",role:"document"},e("div",{className:"modal-content"},e("form",{onsubmit:this.props.onsubmit,"data-role-type":!0},e("div",{className:"modal-header bg-light pb-2"},e("h5",{className:"modal-title"},this.props.title)),e("div",{className:"modal-body"},e("div",{className:"mb-3"},e("label",{htmlFor:"activity_category"},"Kategori Aktivitas ",e("span",{className:"text-danger"},"*")),e("select",{name:"activity_category_id",id:"activity_category",className:"form-control js-choices"},e("option",{value:""},"Pilih"),(a=this.props.activityCategories)==null?void 0:a.map(t=>e("option",{value:t.id},t.id," - ",t.name)))),e("div",{className:"mb-3"},e("label",{htmlFor:"employee"},"Dosen ",e("span",{className:"text-danger"},"*")),e("select",{name:"employee_id",id:"employee",className:"form-control js-choices"},e("option",{value:""},"Pilih"),(s=this.props.employees)==null?void 0:s.map(t=>{var i,r;return e("option",{value:t.id},(i=t.front_title)!=null?i:""," ",t.name," ",(r=t.back_title)!=null?r:"")}))),e("div",{className:"mb-3"},e("label",{htmlFor:"role"},this.props.placeholder," ",e("span",{className:"text-danger"},"*")),e("input",{type:"number",name:"number",id:"number",className:"form-control",placeholder:"",autoComplete:"off"}))),e("div",{className:"modal-footer"},e("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),e("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},e("i",{className:"bx bx-save"})," Simpan"))))))}}b(R,"defaultProps",{onsubmit:null,title:"Untitled Modal",employees:null,activityCategories:null,placeholder:null});const d="lecture/activities",[T,N]=u(""),[S,x]=u(""),[K,F]=u("Tambah Peserta Aktivitas"),[U,C]=u(""),[V,E]=u(""),[z,j]=u("");class W extends w{async componentWillMount(){const a=await c(`${d}/${this.$router.params.id}`,{hideSuccessNotification:!0});a.status==200&&(this.studentActivity=a.data.studentActivity);const s=await c(`${d}/${this.$router.params.id}/get-students`,{hideSuccessNotification:!0});s.status==200&&(this.students=s.data.students);const t=await c(`${d}/get-employees`,{hideSuccessNotification:!0});t.status==200&&(this.employees=t.data.employees);const i=await c(`${d}/get-activity-categories`,{hideSuccessNotification:!0});i.status==200&&(this.activityCategories=i.data.activityCategories)}render(){var a,s,t,i,r,l;return e("div",{className:"intro-y"},e("div",{className:"row"},e("div",{className:"col-12"},e("div",{className:"page-title-box d-sm-flex align-items-center justify-content-between"},e("h4",{className:"mb-sm-0"},(a=this.meta.title)!=null?a:"Untitled Page"),e("div",{className:"page-title-right"},e("div",{className:"breadcrumb"},e("li",{className:"breadcrumb-item"},e("router-name",{name:"apps.dashboard"},"Dashboard")),e("li",{className:"breadcrumb-item"},"Perkuliahan"),e("li",{className:"breadcrumb-item"},e("router-name",{name:"apps.lecture.activities"},"Aktivitas Mahasiswa")),e("li",{className:"breadcrumb-item active title"},(t=(s=this.meta)==null?void 0:s.title)!=null?t:"Untitled Page")))))),e("div",{className:"card"},e("div",{class:"card-body"},e("ul",{class:"nav nav-pills nav-customs nav-danger mb-3",role:"tablist"},e("li",{class:"nav-item"},e("a",{class:"nav-link active","data-bs-toggle":"tab",href:"#arrow-member",role:"tab"},"Peserta Aktivitas")),e("li",{class:"nav-item"},e("a",{class:"nav-link","data-bs-toggle":"tab",href:"#arrow-mentor",role:"tab"},"Dosen Pembimbing")),e("li",{class:"nav-item"},e("a",{class:"nav-link","data-bs-toggle":"tab",href:"#arrow-tester",role:"tab"},"Dosen Penguji"))),e("div",{class:"tab-content text-muted"},e("div",{class:"tab-pane active",id:"arrow-member",role:"tabpanel"},e("div",{className:"text-sm-end text-center mb-3"},e("div",{className:"dt-actions d-inline"}),((i=this.studentActivity)==null?void 0:i.feeder_id)==null?e(y,{data:{redirect:!1,onclick:this.createMember,refresh:!0,filter:!1,permission:"create-activities",title:"Tambah Peserta Aktivitas"}}):""),e("div",{className:"table-responsive table-card mb-1"},e("table",{className:"table zero-configuration",width:"100%",id:"member-dataTable"}))),e("div",{class:"tab-pane",id:"arrow-mentor",role:"tabpanel"},e("div",{className:"text-sm-end text-center mb-3"},((r=this.studentActivity)==null?void 0:r.feeder_id)==null?e(y,{data:{redirect:!1,onclick:this.createSupervisor,refresh:!0,filter:!1,permission:"create-activities",title:"Tambah Dosen Pembimbing"}}):""),e("div",{className:"table-responsive table-card mb-1"},e("table",{className:"table zero-configuration",width:"100%",id:"mentor-dataTable"}))),e("div",{class:"tab-pane",id:"arrow-tester",role:"tabpanel"},e("div",{className:"text-sm-end text-center mb-3"},((l=this.studentActivity)==null?void 0:l.feeder_id)==null?e(y,{data:{redirect:!1,onclick:this.createSupervisor,refresh:!0,filter:!1,permission:"create-activities",title:"Tambah Dosen Penguji"}}):""),e("div",{className:"table-responsive table-card mb-1"},e("table",{className:"table zero-configuration",width:"100%",id:"tester-dataTable"})))))),e(M,{onsubmit:this.memberSubmit,students:this.students,title:K}),e(R,{onsubmit:this.supervisorSubmit,employees:this.employees,activityCategories:this.activityCategories,title:U,placeholder:z}))}componentDidMount(){this.memberTable=g("#member-dataTable",I(this.$router.params.id,this.editDataMember,this.deleteDataMember)),this.mentorTable=g("#mentor-dataTable",P(this.$router.params.id,this.editDataSupervisor,this.deleteDataSupervisor,"0")),this.testerTable=g("#tester-dataTable",P(this.$router.params.id,this.editDataSupervisor,this.deleteDataSupervisor,"1"))}createMember(){N(""),F("Tambah Peserta Aktivitas"),p(),h(),$("#member-modal").modal("show")}async editDataMember(a){N(""),p(),h(),this.showLoading();const{status:s,data:t}=await c(`${d}/${this.$router.params.id}/members/${a}`,{hideSuccessNotification:!0}),{studentActivityMember:i}=t;this.hideLoading(),s==200&&(N(i.id),$(".js-choices")[0].choices.setChoiceByValue(i.student_id),$(".js-choices")[1].choices.setChoiceByValue(i.role_type),$("#member-modal").modal("show"))}async deleteDataMember(a){const{isConfirmed:s}=await this.showConfirm();if(s){this.showLoading();const t=await D(`${d}/${this.$router.params.id}/members/${a}`);this.hideLoading(),t.status==200&&this.memberTable.ajax.reload()}}async memberSubmit(a){a.preventDefault();let s;T==""?s=await v(`${d}/${this.$router.params.id}/members`,a.target):s=await v(`${d}/${this.$router.params.id}/members/${T}`,a.target),s.status==200&&this.memberTable.ajax.reload()}createSupervisor(a){x(""),C(a.target.innerText),E(a.target.innerText=="Tambah Dosen Pembimbing"?"0":"1"),j(a.target.innerText=="Tambah Dosen Pembimbing"?"Dosen Pembimbing Ke":"Dosen Penguji Ke"),p(),h(),$("#supervisor-modal").modal("show")}async editDataSupervisor(a,s){x(""),C(s=="0"?"Edit Dosen Pembimbing":"Edit Dosen Penguji"),j(s=="0"?"Dosen Pembimbing Ke":"Dosen Penguji Ke"),p(),h(),this.showLoading();const{status:t,data:i}=await c(`${d}/${this.$router.params.id}/supervisors/${a}`,{hideSuccessNotification:!0}),{studentActivitySupervisor:r}=i;this.hideLoading(),t==200&&(x(r.id),$(".js-choices")[2].choices.setChoiceByValue(r.activity_category_id),$(".js-choices")[3].choices.setChoiceByValue(r.employee_id),this.updateValue("number",r.number),$("#supervisor-modal").modal("show"))}async deleteDataSupervisor(a){const{isConfirmed:s}=await this.showConfirm();if(s){this.showLoading();const t=await D(`${d}/${this.$router.params.id}/supervisors/${a}`);this.hideLoading(),t.status==200&&(this.mentorTable.ajax.reload(),this.testerTable.ajax.reload())}}async supervisorSubmit(a){a.preventDefault();let s;S==""?s=await v(`${d}/${this.$router.params.id}/supervisors?role_type=${V}`,a.target):s=await v(`${d}/${this.$router.params.id}/supervisors/${S}`,a.target),s.status==200&&(this.mentorTable.ajax.reload(),this.testerTable.ajax.reload())}}b(W,"defaultProps",{memberTable:null,mentorTable:null,TesterTable:null,students:null,employees:null,studentActivity:null,activityCategories:null});export{W as default};
