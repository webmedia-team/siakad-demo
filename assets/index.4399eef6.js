var v=Object.defineProperty;var x=(n,s,i)=>s in n?v(n,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[s]=i;var r=(n,s,i)=>(x(n,typeof s!="symbol"?s+"":s,i),i);import{A as S,a as u,C as N,c as e,g as h,d as C,r as p,h as b,p as g,u as w}from"./index.d57021e8.js";import{i as _}from"./datatable.4b22066f.js";import{m as T}from"./map-actions.609b7ae0.js";import{B as M}from"./button.d257158a.js";/* empty css                 */import{H as D}from"./header-component.8d40ee12.js";import"./jquery.4c77f39d.js";const P=(n,s,i)=>({url:`${S}/lecture/college-class/${n}/weekly-schedules`,table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,id:"code",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender:(t,o,l,a)=>`
        <div class="form-check">
            <input class="form-check-input dt-checkbox" type="checkbox" value="${l.id}">
        </div>`},{title:"No",data:"id",name:"id",searchable:!1,orderable:!1,width:"5%",mRender:(t,o,l,a)=>a.row+a.settings._iDisplayStart+1},{title:"Hari",data:"formatted_time",name:"formatted_time",defaultContent:"-",mRender:(t,o,l,a)=>l.day.name+", <br> "+t},{title:"Ruang",data:"room.name",name:"room.name",defaultContent:"-",mRender(t,o,l){var a,d;return typeof t<"u"?t+(typeof((a=l.room)==null?void 0:a.location)<"u"?` - ${(d=l.room)==null?void 0:d.location}`:""):"-"}},{title:"Jenis Pertemuan",data:"meeting_type.name",name:"meeting_type.name",defaultContent:"-"},{title:"Metode Pembelajaran",data:"learning_method",name:"learning_method",defaultContent:"-",mRender:function(t){return t.toUpperCase()}},{title:"",data:"id",name:"id",searchable:!1,orderable:!1,sClass:"text-center nowrap",mRender:(t,o,l,a)=>{var d="";return l.college_class.feeder_id==null&&(u().includes("update-weekly-schedules")&&(d+=`<button type="button" class="btn btn-outline-primary btn-sm mx-1" data-toggle="edit" data-id="${t}"><i class="bx bx-edit-alt"></i></button>`),u().includes("delete-weekly-schedules")&&(d+=`<button type="button" class="btn btn-outline-danger btn-sm mx-1" data-toggle="delete" data-id="${t}"><i class="bx bx-trash"></i></button>`)),d}}],callback:()=>{$('button[data-toggle="delete"]').unbind().on("click",function(t){t.preventDefault(),i($(this).data("id"))}),$('button[data-toggle="edit"]').unbind().on("click",function(t){t.preventDefault(),s($(this).data("id"))})}});class k extends N{render(){var s,i,t,o,l;return e("div",{className:"modal fade",id:"weekly-schedule-modal",role:"dialog"},e("div",{className:"modal-dialog",role:"document"},e("div",{className:"modal-content"},e("form",{onsubmit:this.props.onsubmit},e("div",{className:"modal-header bg-light pb-2"},e("h5",{className:"modal-title"},this.props.title)),e("div",{className:"modal-body"},e("div",{className:"mb-3"},e("label",{htmlFor:"day",className:"form-label"},"Hari ",e("i",{className:"text-danger"},"*")),e("select",{name:"day",id:"day",className:"form-control js-choices","data-choices-sorting-by-value":!0},e("option",{value:""},"Pilih Hari"),(s=this.props.days)==null?void 0:s.map(a=>e("option",{value:a.id},a.name)))),e("div",{className:"mb-3"},e("label",{htmlFor:"meeting-type",className:"form-label"},"Jenis Pertemuan ",e("i",{className:"text-danger"},"*")),e("select",{name:"meeting_type",id:"meeting-type",className:"form-control js-choices"},e("option",{value:""},"Pilih Jenis Pertemuan"),(i=this.props.meetingTypes)==null?void 0:i.map(a=>e("option",{value:a.id},a.name)))),e("div",{className:"mb-3"},e("label",{htmlFor:"room",className:"form-label"},"Ruangan "),e("select",{name:"room",id:"room",className:"form-control js-choices"},e("option",{value:""},"Pilih Ruangan"),(t=this.props.rooms)==null?void 0:t.map(a=>e("option",{value:a.id},a.name,a!=null&&a.location?` - ${a==null?void 0:a.location}`:"")))),e("div",{className:"mb-3"},e("label",{htmlFor:"time-start",className:"form-label"},"Waktu Mulai",e("i",{className:"text-danger"},"*")),e("select",{name:"time_start",id:"time-start",className:"form-control js-choices"},e("option",{value:""},"Pilih Waktu Mulai"),(o=this.props.timeSlots)==null?void 0:o.map(a=>e("option",{value:a.time},a.time.split(":")[0]+":"+a.time.split(":")[1])))),e("div",{className:"mb-3"},e("label",{htmlFor:"time-end",className:"form-label"},"Waktu Berakhir",e("i",{className:"text-danger"},"*")),e("select",{name:"time_end",id:"time-end",className:"form-control js-choices"},e("option",{value:""},"Pilih Waktu Berakhir"),(l=this.props.timeSlots)==null?void 0:l.map(a=>e("option",{value:a.time},a.time.split(":")[0]+":"+a.time.split(":")[1])))),e("div",{className:"mb-3"},e("label",{htmlFor:"learning-method",className:"form-label"},"Metode Pembelajaran ",e("i",{className:"text-danger"},"*")),e("select",{name:"learning_method",id:"metode-pembelajaran",className:"form-control js-choices"},e("option",{value:""},"Pilih Metode Pembelajaran"),e("option",{value:"online"},"Online"),e("option",{value:"offline"},"Offline"),e("option",{value:"hybrid"},"Hybrid")))),e("div",{className:"modal-footer"},e("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),e("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},e("i",{className:"bx bx-save"})," Simpan"))))))}}r(k,"defaultProps",{onsubmit:null,title:"Untitled Modal",collegeClasses:[],days:[],meetingTypes:[],rooms:[],timeSlots:[]});const m="lecture/college-class",[j,y]=w("Tambah Jadwal Minggu"),[f,c]=w("");class R extends N{async componentWillMount(){const s=await h(`lecture/college-class/schedule/${this.$router.params.id}`,{hideSuccessNotification:!0});this.collegeClass=s.data.collegeClass;const i=await this.getDays();i.status==200&&(this.days=i.data.days);const t=await this.getMeetingTypes();t.status==200&&(this.meetingTypes=t.data.meetingTypes);const o=await this.getRooms();o.status==200&&(this.rooms=o.data.rooms);const l=await this.getTimeSlots();l.status==200&&(this.timeSlots=l.data.timeSlots)}render(){return e("div",{className:"intro-y"},e(D,{id:this.$router.params.id}),e("div",{className:"card shadow-sm mb-3"},e("div",{className:"card-header border-0"},e("div",{className:"text-sm-end text-center"},e("div",{className:"dt-actions d-inline"}),e(M,{data:{redirect:!1,filter:!1,refresh:!0,onclick:this.createData,create:this.collegeClass.feeder_id==null,title:"Tambah Jadwal Mingguan",permission:"create-weekly-schedules"}}))),e("div",{className:"card-body"},e("div",{className:"table-responsive table-card mb-1"},e("table",{className:"table zero-configuration",width:"100%",id:"dataTable"})))),e(k,{onsubmit:this.submit,title:j,days:this.days,meetingTypes:this.meetingTypes,rooms:this.rooms,timeSlots:this.timeSlots}))}componentDidMount(){this.table=_("#dataTable",P(this.$router.params.id,this.updateData,this.deleteData)),this.choices=$(".js-choices")}async deleteData(s){let{isConfirmed:i}=await this.showConfirm();if(i){this.showLoading();const t=await C(`${m}/${this.$router.params.id}/weekly-schedules/${s}`);this.hideLoading(),t.status==200&&this.table.ajax.reload()}}async updateData(s){y("Edit Jadwal Mingguan"),c(""),p(),b(),this.showLoading();const{status:i,data:t}=await h(`${m}/${this.$router.params.id}/weekly-schedules/${s}`,{hideSuccessNotification:!0});this.hideLoading(),i==200&&(c(t.weeklySchedule.id),this.choices[0].choices.setChoiceByValue(t.weeklySchedule.day_id.toString()),this.choices[1].choices.setChoiceByValue(t.weeklySchedule.meeting_type_id.toString()),this.choices[2].choices.setChoiceByValue(t.weeklySchedule.room_id.toString()),this.choices[3].choices.setChoiceByValue(t.weeklySchedule.time_start),this.choices[4].choices.setChoiceByValue(t.weeklySchedule.time_end),this.choices[5].choices.setChoiceByValue(t.weeklySchedule.learning_method),$("#weekly-schedule-modal").modal("show"))}async submit(s){s.preventDefault();let i;f==""?i=await g(`${m}/${this.$router.params.id}/weekly-schedules`,s.target):i=await g(`${m}/${this.$router.params.id}/weekly-schedules/${f}`,s.target),i.status==200&&(this.$router.reload(),this.table.ajax.reload)}async createData(){y("Tambah Jadwal Mingguan"),c(""),p(),b(),$("#weekly-schedule-modal").modal("show")}}r(R,"defaultProps",{...T(["getDays","getMeetingTypes","getRooms","getTimeSlots"]),table:null,days:[],meetingTypes:[],rooms:[],timeSlots:[],choices:null,collegeClass:null});export{R as default};
