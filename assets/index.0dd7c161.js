var C=Object.defineProperty;var F=(r,i,e)=>i in r?C(r,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[i]=e;var u=(r,i,e)=>(F(r,typeof i!="symbol"?i+"":i,e),e);import{A as _,a as p,C as b,c as a,p as c,S,d as M,u as P,B as K}from"./index.d57021e8.js";import{B as j}from"./button.d257158a.js";import{i as B}from"./datatable.4b22066f.js";import{m as R}from"./map-actions.609b7ae0.js";/* empty css                 */import"./jquery.4c77f39d.js";const L=(r,i,e)=>({url:_+"/portal/college-students",table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,id:"id",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender(t,s,l,o){return`
                    <div class="form-check">
                        <input class="form-check-input dt-checkbox" type="checkbox" value="${l.id}">
                    </div>`}},{title:"No",data:"id",name:"id",searchable:!1,orderable:!1,width:"5%",mRender(t,s,l,o){return o.row+o.settings._iDisplayStart+1}},{title:"NIM",data:"nim",name:"nim",mRender:t=>t||"-"},{title:"Nama",data:"name",name:"name"},{title:"Jenis Kelamin",data:"gender",name:"gender",mRender:function(t){return t=="L"?"Laki-Laki":"Perempuan"}},{title:"Program Studi",data:"study_program_id",name:"study_program_id",mRender(t,s,l){return t==null?"-":l.study_program.education_level.code+" - "+l.study_program.name}},{title:"Angkatan",data:"academic_period_id",name:"academic_period_id",mRender(t,s,l){return t==null?"-":l.academic_period.academic_year_id}},{title:"Status",data:"student_status_id",name:"student_status_id",mRender(t,s,l){return t==null?"-":`<strong>${l.student_status.name}</strong>`}},{title:"Smt",data:"academic_period_id",name:"academic_period_id",mRender(t,s,l){return l.student_college_activity_count}},{title:"IPK",data:"grade",name:"grade"},{title:"",data:"id",name:"id",searchable:!1,orderable:!1,sClass:"text-center nowrap",mRender:(t,s,l,o)=>{var n="";return p().includes("read-college-students")&&(n+=`<button type="button" class="btn btn-outline-warning btn-sm mx-1" data-toggle="detail" data-id="${t}"><i class="bx bx-menu"></i></button>`),p().includes("update-college-students")&&(n+=`<button type="button" class="btn btn-outline-primary btn-sm mx-1" data-toggle="edit" data-id="${t}"><i class="bx bx-edit-alt"></i></button>`),p().includes("delete-college-students")&&(n+=`<button type="button" class="btn btn-outline-danger btn-sm mx-1" data-toggle="delete" data-id="${t}"><i class="bx bx-trash"></i></button>`),n}}],callback:()=>{$('button[data-toggle="detail"]').unbind().on("click",function(t){t.preventDefault(),e($(this).data("id"))}),$('button[data-toggle="edit"]').unbind().on("click",function(t){t.preventDefault(),r($(this).data("id"))}),$('button[data-toggle="delete"]').unbind().on("click",function(t){t.preventDefault(),i($(this).data("id"))})},options:{order:[6,"desc"]}});class D extends b{render(){return a("div",{className:"modal fade",id:"form-set",role:"dialog"},a("div",{className:"modal-dialog",role:"document"},a("div",{className:"modal-content"},a("form",{onsubmit:this.props.onsubmit},a("div",{className:"modal-header bg-light pb-2"},a("h5",{className:"modal-title"},this.props.title)),a("div",{className:"modal-body"},a("div",{id:"content-modal-set"})),a("div",{className:"modal-footer"},a("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),a("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},a("i",{className:"bx bx-save"})," Simpan"))))))}}u(D,"defaultProps",{onsubmit:null,title:"Untitled Modal"});class T extends b{render(){return a("div",{className:"modal fade",id:"form-import",role:"dialog"},a("div",{className:"modal-dialog",role:"document"},a("div",{className:"modal-content"},a("form",{encType:"multipart/form-data",onSubmit:this.props.onsubmit},a("div",{className:"modal-header bg-light pb-2"},a("h5",{className:"modal-title"},this.props.title)),a("div",{className:"modal-body"},a("div",{className:"mb-3"},a("button",{type:"button",onClick:this.props.ondownload,className:"btn btn-sm btn-primary"},a("i",{className:"bx bx-receipt"})," Template")),a("div",{id:""},a("div",{className:"mb-3"},a("label",{for:"file",className:"form-label"},"File Import"),a("br",null),a("input",{type:"file",name:"file_import",id:"file_import",className:"filepond",required:!0}),a("code",{className:""},"excel")))),a("div",{className:"modal-footer"},a("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),a("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},a("i",{className:"bx bx-save"})," Simpan"))))))}}u(T,"defaultProps",{onsubmit:null,ondownload:null,title:"Untitled Modal"});const[w,m]=P("");P("");const A=_+"/portal/college-students",d="portal/college-students";class Y extends b{async componentWillMount(){const i={model:["registrationType","curriculums","academicYears","lectureSystem","studyPrograms","studentStatuses","registrationPath","getClassGroups","curriculums"]},{status:e,data:t}=await this.getData(i);e==200&&(this.studyPrograms=t.studyPrograms,this.academicYears=t.academicYears,this.studentStatuses=t.studentStatuses,this.lectureSystem=t.lectureSystem,this.registrationType=t.registrationType,this.curriculums=t.curriculums,this.registrationPath=t.registrationPath,this.classGroup=t.getClassGroups,this.curriculum=t.curriculums)}render(){var i,e;return a("div",{className:"intro-y"},a("div",{className:"row"},a("div",{className:"col-12"},a("div",{className:"page-title-box d-sm-flex align-items-center justify-content-between"},a("h4",{className:"mb-sm-0"},(i=this.meta.title)!=null?i:"Untitled Page"),a("div",{className:"page-title-right"},a("ol",{className:"breadcrumb"},a("li",{className:"breadcrumb-item"},a("router-name",{name:"apps.dashboard"},"Dashboard")),a("li",{className:"breadcrumb-item active"},"Portal"),a("li",{className:"breadcrumb-item active"},(e=this.meta.title)!=null?e:"Untitled Page")))))),a("div",{className:"row"},a("div",{className:"col-lg-3 col-md-4 dt-filter-card",style:"display: block;"},a("div",{className:"card"},a("div",{className:"card-header"},a("h3",{className:"card-title mb-0"},a("i",{className:"bx bx-filter"})," Filter Mahasiswa"),a("div",{id:"filterData"})),a("div",{className:"card-body p-0"},a("div",{className:"accordion",id:"collegeStudentFiltered"},a("div",{className:"accordion-item"},a("div",{className:"accordion-header"},a("a",{className:"accordion-button text-dark p-3","data-bs-toggle":"collapse",href:"#programStudies",role:"button","aria-expanded":"true","aria-controls":"programStudies"},"Unit / Program Studi")),a("div",{class:"accordion-collapse collapse show p-3",id:"programStudies",style:"background: #f0f7fc;max-height: 300px;overflow-y: scroll","data-bs-parent":"#collegeStudentFiltered"},a("ul",{class:"mb-0 pb-0"},this.studyPrograms.map(t=>a("li",{className:"py-2"},a("a",{href:"",onClick:this.filtering,"data-name":"studyPrograms","data-value":t.id},t.education_level.code," - ",t.name)))))),a("div",{className:"accordion-item"},a("div",{className:"accordion-header"},a("a",{className:"accordion-button text-dark p-3 collapsed","data-bs-toggle":"collapse",href:"#academicPeriode",role:"button","aria-expanded":"false","aria-controls":"academicPeriode"},"Angkatan")),a("div",{class:"accordion-collapse collapse p-3",id:"academicPeriode",style:"background: #f0f7fc;max-height: 300px;overflow-y: scroll","data-bs-parent":"#collegeStudentFiltered"},a("ul",{class:"mb-0 pb-0"},this.academicYears.map(t=>a("li",{className:"py-2"},a("a",{href:"",onClick:this.filtering,"data-name":"academicYears","data-value":t.id},t.name)))))),a("div",{className:"accordion-item"},a("div",{className:"accordion-header"},a("a",{className:"accordion-button text-dark p-3 collapsed","data-bs-toggle":"collapse",href:"#studentStatus",role:"button","aria-expanded":"false","aria-controls":"studentStatus"},"Status Mahasiswa")),a("div",{class:"accordion-collapse collapse p-3",id:"studentStatus",style:"background: #f0f7fc;max-height: 300px;overflow-y: scroll","data-bs-parent":"#collegeStudentFiltered"},a("ul",{class:"mb-0 pb-0"},this.studentStatuses.map(t=>a("li",{className:"py-2"},a("a",{href:"",onClick:this.filtering,"data-name":"studentStatuses","data-value":t.id},t.name)))))),a("div",{className:"accordion-item"},a("div",{className:"accordion-header"},a("a",{className:"accordion-button text-dark p-3 collapsed","data-bs-toggle":"collapse",href:"#collegeSystem",role:"button","aria-expanded":"false","aria-controls":"collegeSystem"},"Sistem Kuliah")),a("div",{class:"accordion-collapse collapse p-3",id:"collegeSystem",style:"background: #f0f7fc;max-height: 300px;overflow-y: scroll","data-bs-parent":"#collegeStudentFiltered"},a("ul",{class:"mb-0 pb-0"},this.lectureSystem.map(t=>a("li",{className:"py-2"},a("a",{href:"",onClick:this.filtering,"data-name":"lectureSystems","data-value":t.hashid},t.name)))))),a("div",{className:"accordion-item"},a("div",{className:"accordion-header"},a("a",{className:"accordion-button text-dark p-3 collapsed","data-bs-toggle":"collapse",href:"#registrationType",role:"button","aria-expanded":"false","aria-controls":"registrationType"},"Jenis Pendaftaran")),a("div",{class:"accordion-collapse collapse p-3",id:"registrationType",style:"background: #f0f7fc;max-height: 300px;overflow-y: scroll","data-bs-parent":"#collegeStudentFiltered"},a("ul",{class:"mb-0 pb-0"},this.registrationType.map(t=>a("li",{className:"py-2"},a("a",{href:"",onClick:this.filtering,"data-name":"registrationTypes","data-value":t.id},t.name)))))),a("div",{className:"accordion-item"},a("div",{className:"accordion-header"},a("a",{className:"accordion-button text-dark p-3 collapsed","data-bs-toggle":"collapse",href:"#curriculum",role:"button","aria-expanded":"false","aria-controls":"curriculum"},"Kurikulum")),a("div",{class:"accordion-collapse collapse p-3",id:"curriculum",style:"background: #f0f7fc;max-height: 300px;overflow-y: scroll","data-bs-parent":"#collegeStudentFiltered"},a("ul",{class:"mb-0 pb-0"},this.curriculums.map(t=>a("li",{className:"py-2"},a("a",{href:"",onClick:this.filtering,"data-name":"curriculums","data-value":t.id},t.name)))))),a("div",{className:"accordion-item"},a("div",{className:"accordion-header"},a("a",{className:"accordion-button text-dark p-3 collapsed","data-bs-toggle":"collapse",href:"#gender",role:"button","aria-expanded":"false","aria-controls":"gender"},"Jenis Kelamin")),a("div",{class:"accordion-collapse collapse p-3",id:"gender",style:"background: #f0f7fc;max-height: 300px;overflow-y: scroll","data-bs-parent":"#collegeStudentFiltered"},a("ul",{class:"mb-0 pb-0"},a("li",{className:"py-2"},a("a",{href:"",onClick:this.filtering,"data-name":"genders","data-value":"L"},"Laki - laki")),a("li",{className:"py-2"},a("a",{href:"",onClick:this.filtering,"data-name":"genders","data-value":"P"},"Perempuan"))))))))),a("div",{className:"col"},a("div",{className:"card"},a("div",{className:"card-header border-0"},a("div",{className:"text-sm-end text-center"},a("div",{className:"dt-actions d-inline"}),a(j,{data:{redirect:!0,target:"apps.portal.college-students.student-create",filter:!0,refresh:!0,permission:"create-college-students",title:"Tambah Mahasiswa"}}),a("div",{className:"dropdown d-inline"},a("button",{className:"btn btn-warning dropdown-toggle","data-bs-toggle":"dropdown"},a("i",{className:"bx bx-cog"})," Aksi"),a("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1","data-popper-placement":"bottom-start",style:"position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate(0px, 40px);"},a("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:()=>this.setData(5)},"Set Kelas/Kelompok"),a("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:()=>this.setData(6)},"Set Kurikulum"),a("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:()=>this.setData(1)},"Set Jalur Pendaftaran"),a("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:()=>this.setData(2)},"Set Jenis Pendaftaran"),a("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:()=>this.setData(4)},"Set Sistem Kuliah"),a("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:()=>this.setData(3)},"Set Tanggal Masuk"),a("a",{class:"dropdown-item",href:"javascript: void(0)",onClick:()=>this.setImport("import")},"Import Mahasiswa"))))),a("div",{className:"card-body"},a("div",{className:"table-responsive table-card mb-1"},a("table",{className:"table zero-configuration",width:"100%",id:"dataTable"})),a("div",{class:"alert alert-warning alert-border-left alert-dismissible fade show pb-3",role:"alert"},a("h5",{className:"mb-4"},a("strong",null,"Status")),a("div",{className:"row"},this.studentStatuses.map(t=>a("div",{className:"col-md-3"},a("strong",null,t.id)," : ",t.name)))))))),a(D,{title:w,onsubmit:this.submitSet}),a(T,{title:w,onsubmit:this.submitSetFile,ondownload:this.downloadSet}))}componentDidMount(){this.table=B("#dataTable",L(this.updateData,this.deleteData,this.showDetail))}async showDetail(i){this.$router.pushName("apps.portal.college-students.student-detail",{id:i})}async updateData(i){this.$router.pushName("apps.portal.college-students.update",{id:i})}filtering(i){i.preventDefault(),$(`*[data-name="${$(i.target).data("name")}"`).removeAttr("data-active"),$(i.target).attr("data-active",!0),this.reloadTable();let e=[];$("*[data-active]").each((t,s)=>{e.push({name:$(s).data("name"),value:$(s).html()})}),document.querySelector("#filterData").innerHTML="",document.querySelector("#filterData").appendChild(this.renderFilterData(e))}removeFilter(i){i.preventDefault(),$(`*[data-name="${$(i.target).data("name")}"]`).removeAttr("data-active"),this.reloadTable();let e=[];$("*[data-active]").each((t,s)=>{e.push({name:$(s).data("name"),value:$(s).html()})}),document.querySelector("#filterData").innerHTML="",document.querySelector("#filterData").appendChild(this.renderFilterData(e))}renderFilterData(i){return a("div",null,i.map(e=>a("span",{className:"badge bg-info py-2 pb-1 me-2 mt-2"},e.value," ",a("i",{className:"mdi mdi-close-circle font-lg","data-name":e.name,onClick:this.removeFilter,style:"cursor: pointer"}))))}reloadTable(){var g,f,v,y,k,N,x;let i=A,e=(g=$('*[data-name="studyPrograms"][data-active]').data("value"))!=null?g:"all",t=(f=$('*[data-name="academicYears"][data-active]').data("value"))!=null?f:"all",s=(v=$('*[data-name="studentStatuses"][data-active]').data("value"))!=null?v:"all",l=(y=$('*[data-name="lectureSystems"][data-active]').data("value"))!=null?y:"all",o=(k=$('*[data-name="registrationTypes"][data-active]').data("value"))!=null?k:"all",n=(N=$('*[data-name="curriculums"][data-active]').data("value"))!=null?N:"all",h=(x=$('*[data-name="genders"][data-active]').data("value"))!=null?x:"all";typeof e<"u"&&(i=`${i}?study_program_id=${e}`),typeof t<"u"&&(i=`${i}&academic_year_id=${t}`),typeof s<"u"&&(i=`${i}&student_status_id=${s}`),typeof l<"u"&&(i=`${i}&lecture_system_id=${l}`),typeof o<"u"&&(i=`${i}&registration_type_id=${o}`),typeof n<"u"&&(i=`${i}&curriculum_id=${n}`),typeof h<"u"&&(i=`${i}&gender=${h}`),this.table.ajax.url(i).load()}setImport(i){m("Import"),$("#form-import").modal("show")}async downloadSet(i){i.preventDefault();const e=`${K}/api/v1/students/download-template-import-data`,t=window.open(`${e}`,"_blank","resizable=yes,scrollbars=yes,status=yes");t&&(t.opener=null,t.location=`${e}`,t.addEventListener("beforeunload",function(){t.location=`${e}`}),setTimeout(function(){t.close()},4e3))}async submitSetFile(i){i.preventDefault();let e;e=await c(`${d}/excel`,i.target),console.log(e),e.status==200&&(this.$router.reload(),this.table.ajax.reload())}setData(i){let e="";if($(".dt-checkbox:checked").length>0){$(".dt-checkbox:checked");var t="";$.each($(".dt-checkbox:checked"),function(){t+=`<input type="hidden" name="student[]" id='student' value="${$(this).val()}">`})}$(".dt-checkbox:checked").length>0?(i==1?(m("Set Jalur Pendaftaran"),e="<div class='mb-3'>",e+="<label>Pilih Jalur Pendaftaran</label>",e+=`<select class="form-control" name='registration_path'>`,e+="<option value=''>Pilih</option>",this.registrationPath.map(s=>e+=`<option value='${s.id}'>${s.name}</option>`),e+="</select>",e+="</div>",e+=`<input type='hidden' name="indikator" id="indikator" value="registrationPath">`):i==2?(m("Set Jenis Pendaftaran"),e="<div class='mb-3'>",e+="<label>Pilih Jenis Pendaftaran</label>",e+=`<select class="form-control" name='registration_type'>`,e+="<option value=''>Pilih</option>",this.registrationType.map(s=>e+=`<option value='${s.id}'>${s.name}</option>`),e+="</select>",e+="</div>",e+='<input type="hidden" name="indikator" id="indikator" value="registrationType">'):i==3?(m("Set Tanggal Masuk"),e="<div class='mb-3'>",e+="<label>Tanggal Masuk</label>",e+='<input type="date" name="date" id="tanggal_masuk" class="form-control flatpickr-date">',e+="</div>",e+='<input type="hidden" name="indikator" id="indikator" value="date">'):i==4?(m("Set Sistem Kuliah"),e="<div class='mb-3'>",e+="<label>Pilih Sistem Kuliah</label>",e+=`<select class="form-control" name='lecture_system'>`,e+="<option value=''>Pilih</option>",this.lectureSystem.map(s=>e+=`<option value='${s.hashid}'>${s.name}</option>`),e+="</select>",e+="</div>",e+='<input type="hidden" name="indikator" id="indikator" value="lectureSystem">'):i==5?(m("Set Kelas/Kelompok"),e="<div class='mb-3'>",e+="<label>Pilih Kelas/Kelompok</label>",e+=`<select class="form-control" name='class_group'>`,e+="<option value=''>Pilih</option>",this.classGroup.map(s=>e+=`<option value='${s.hashid}'>${s.name}</option>`),e+="</select>",e+="</div>",e+='<input type="hidden" name="indikator" id="indikator" value="classGroup">'):i==6&&(m("Set Kurikulum"),e="<div class='mb-3'>",e+="<label>Pilih Kurikulum</label>",e+=`<select class="form-control js-choices" name='curriculum'>`,e+="<option value=''>Pilih</option>",this.curriculum.map(s=>e+=`<option value='${s.id}'>${s.name}</option>`),e+="</select>",e+="</div>",e+='<input type="hidden" name="indikator" id="indikator" value="curriculum">'),e+=t,$("#content-modal-set").html(e),$("#form-set").modal("show")):S.fire({icon:"error",title:"Error!",text:"Mohon untuk memilih Mahasiswa!"})}async submitSet(i){i.preventDefault();let e;$("#indikator").val()=="registrationPath"?e=await c(`${d}/set-registration-paths`,i.target):$("#indikator").val()=="registrationType"?e=await c(`${d}/set-registration-types`,i.target):$("#indikator").val()=="date"?e=await c(`${d}/set-student-entrydate`,i.target):$("#indikator").val()=="lectureSystem"?e=await c(`${d}/set-lecture-system`,i.target):$("#indikator").val()=="classGroup"?e=await c(`${d}/set-class-group`,i.target):$("#indikator").val()=="curriculum"&&(e=await c(`${d}/set-curriculum`,i.target)),e.status==200&&(this.$router.reload(),this.table.ajax.reload)}async deleteData(i){S.fire({title:"Hapus ?",icon:"question",text:"Data yang dihapus tidak dikembalikan",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Ya, lanjutkan",cancelButtonText:"Batal",confirmButtonColor:"#d1403b"}).then(async e=>{e.isConfirmed&&(await M(`${d}/${i}`)).status==200&&this.table.ajax.reload()})}}u(Y,"defaultProps",{...R(["getStudyPrograms","getAcademicYears","getStudentStatuses","getLectureSystem","getRegistrationType","getCurriculums","getData"]),table:null,studyPrograms:[],academicYears:[],studentStatuses:[],lectureSystem:[],registrationType:[],curriculums:[],registrationPath:[],classGroup:[],curriculum:[]});export{Y as default};
