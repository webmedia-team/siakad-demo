var m=Object.defineProperty;var u=(s,t,e)=>t in s?m(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var o=(s,t,e)=>(u(s,typeof t!="symbol"?t+"":t,e),e);import{A as p,C as h,c as a,p as r,S as c}from"./index.d57021e8.js";import{i as f}from"./datatable.4b22066f.js";import{B as b}from"./button.d257158a.js";import{m as g}from"./map-actions.609b7ae0.js";import"./jquery.4c77f39d.js";const y=()=>({url:`${p}/feeder/student`,table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,id:"id",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender(s,t,e,i){return`
                    <div class="form-check">
                        <input class="form-check-input dt-checkbox" type="checkbox" value="${e.id}">
                    </div>`}},{title:"No",data:"id",name:"id",searchable:!1,orderable:!1,width:"5%",mRender(s,t,e,i){return i.row+i.settings._iDisplayStart+1}},{title:"NIM",data:"nim",name:"nim",mRender:s=>s||"-"},{title:"Nama",data:"name",name:"name"},{title:"L/P",data:"gender",name:"gender"},{title:"Agama",data:"religion.name",name:"religion.name"},{title:"Tanggal Lahir",data:"birthdate",name:"birthdate",defaultContent:"-"},{title:"Program Studi",data:"study_program_id",name:"study_program_id",mRender(s,t,e){return s==null?"-":e.study_program.education_level.code+" - "+e.study_program.name}},{title:"Angkatan",data:"academic_period_id",name:"academic_period_id",mRender(s,t,e){return s==null?"-":e.academic_period.academic_year_id}},{title:"Status",data:"student_status_id",name:"student_status_id",mRender(s,t,e){return s==null?"-":`<strong>${e.student_status.name}</strong>`}},{title:"Status",data:"feeder_id",name:"feeder_id",mRender:(s,t,e,i)=>{let d=`<span class="badge p-1 badge-soft-${s!=null?"success":"warning"} text-uppercase">
                        <i class="${s!=null?"ri-checkbox-circle-fill":"ri-alert-fill"} me-1 align-middle fs-16"></i>
                        ${s!=null?"Sudah Sync":"Belum Sync"}
                    </span>`;return e.feeder_description!=null&&(d+=`<br>
                            <span class="badge p-1 badge-soft-danger mt-2">
                                <i class="ri-error-warning-fill me-1 align-middle fs-16"></i>
                                ${e.feeder_description}
                            </span>
                        `),d}}],callback:()=>{},options:{order:[8,"desc"]}}),l="feeder/student/sync";class v extends h{render(){var t,e,i;return a("div",{className:"intro-y"},a("div",{className:"page-title-box d-sm-flex align-items-center justify-content-between"},a("h4",{className:"mb-sm-0"},this.meta.title)),a("div",{className:"card dt-filter-card"},a("div",{className:"card-body"},a("div",{className:"row"},a("div",{className:"col-3"},a("label",{htmlFor:""},"Program Studi"),a("select",{name:"study_program_id",id:"study-program",className:"from-control js-choices dt-filter-input"},a("option",{value:"",selected:!0},"Pilih"),a("option",{value:"all"},"Semua Program Studi"),(t=this.studyPrograms)==null?void 0:t.map(d=>{var n;return a("option",{value:d.id},(n=d.education_level)==null?void 0:n.code," - ",d.name)}))),a("div",{className:"col-3"},a("label",{htmlFor:""},"Angkatan"),a("select",{name:"academic_year_id",id:"academic-year",className:"from-control js-choices dt-filter-input"},a("option",{value:""},"Pilih"),a("option",{value:"all"},"Semua Angkatan"),(e=this.academicYears)==null?void 0:e.map(d=>a("option",{value:d.id},d.name)))),a("div",{className:"col-3"},a("label",{htmlFor:""},"Status Mahasiswa"),a("select",{name:"student_status_id",id:"student-status",className:"from-control js-choices dt-filter-input"},a("option",{value:""},"Pilih"),a("option",{value:"all"},"Semua Status Mahasiswa"),(i=this.studentStatuses)==null?void 0:i.map(d=>a("option",{value:d.id},d.name)))),a("div",{className:"col-3"},a("label",{htmlFor:""},"Sync"),a("select",{name:"sync",id:"sync",className:"from-control js-choices dt-filter-input"},a("option",{value:"all",selected:!0},"Semua"),a("option",{value:"0"},"Sudah Sync"),a("option",{value:"1"},"Belum Sync")))))),a("div",{className:"card shadow-sm mb-3"},a("div",{className:"card-header border-0"},a("div",{className:"row"},a("div",{className:"text-sm-end text-center"},a("div",{className:"dt-actions d-inline"}),a(b,{data:{refresh:!0,create:!1,filter:!0}}),a("div",{className:"dropdown d-inline"},a("button",{className:"btn btn-primary dropdown-toggle","data-bs-toggle":"dropdown"},a("i",{className:"bx bx-sync"})," Sync Feeder"),a("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1","data-popper-placement":"bottom-start",style:"position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate(0px, 40px);"},a("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:this.downloadData},a("i",{className:"bx bx-download"})," Tarik Data Feeder"),a("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:this.uploadData},a("i",{className:"bx bx-upload"})," Upload Data"),a("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:this.updateData},a("i",{className:"bx bx-refresh"})," Update Data"),a("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:this.deleteData},a("i",{className:"bx bx-trash"})," Delete Data")))))),a("div",{className:"card-body"},a("div",{className:"table-responsive table-card mb-1"},a("table",{className:"table zero-configuration",width:"100%",id:"dataTable"})))))}componentDidMount(){this.table=f("#dataTable",y())}async componentWillMount(){const{status:t,data:e}=await this.getData({model:["studyPrograms","studentStatuses","academicYears"]});this.studyPrograms=e.studyPrograms,this.studentStatuses=e.studentStatuses,this.academicYears=e.academicYears}async downloadData(){let t,e=new FormData;e.append("act","getStudent"),t=await r(`${l}`,e,{},!1),t.status==200&&(this.$router.reload(),this.table.ajax.reload)}async uploadData(){let t,e=new FormData;var i=window.checkedDataIds;if(e.append("act","uploadStudent"),$(".dt-checkbox:checked").length<1)e.append("study_program_id",$("#study-program").val()),e.append("student_status_id",$("#student-status").val()),e.append("academic_year_id",$("#academic-year").val()),e.append("sync",$("#sync").val()),t=await r(`${l}`,e,{},!1);else{for(const d of i)e.append("students[]",d);t=await r(`${l}`,e,{},!1)}t.status==200&&(this.$router.reload(),this.table.ajax.reload)}async updateData(){var t=window.checkedDataIds;if($(".dt-checkbox:checked").length<1)c.fire({title:"Update Feeder gagal!",text:"Anda harus memilih Mahasiswa",icon:"error",confirmButtonColor:"#d1403b"});else{let e,i=new FormData;i.append("act","updateStudent");for(const d of t)i.append("students[]",d);e=await r(`${l}`,i,{},!1),e.status==200&&(this.$router.reload(),this.table.ajax.reload)}}async deleteData(){var t=window.checkedDataIds;if($(".dt-checkbox:checked").length<1)c.fire({title:"Delete Feeder gagal!",text:"Anda harus memilih Mahasiswa",icon:"error",confirmButtonColor:"#d1403b"});else{let e,i=new FormData;i.append("act","deleteStudent");for(const d of t)i.append("students[]",d);e=await r(`${l}`,i,{},!1),e.status==200&&(this.$router.reload(),this.table.ajax.reload)}}}o(v,"defaultProps",{...g(["getData"]),table:null,studyPrograms:[],studentStatuses:[],academicYears:[]});export{v as default};
