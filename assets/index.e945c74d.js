var b=Object.defineProperty;var g=(i,s,a)=>s in i?b(i,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[s]=a;var n=(i,s,a)=>(g(i,typeof s!="symbol"?s+"":s,a),a);import{A as f,i as d,a as v,C as p,c as e,g as o,d as y,p as u}from"./index.d57021e8.js";import{H as N}from"./header-component.8d40ee12.js";import{i as w}from"./datatable.4b22066f.js";import"./jquery.4c77f39d.js";/* empty css                 */import{m as _}from"./map-actions.609b7ae0.js";const x=(i,s,a)=>({url:`${f}/lecture/college-class/${i}/class-participants`,table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,checkboxes:!0,id:"code",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender:(t,c,l,r)=>`
                    <div class="form-check">
                        <input class="form-check-input dt-checkbox" type="checkbox" value="${l.id}">
                    </div>`},{title:"No",data:"id",name:"id",searchable:!1,orderable:!1,width:"5%",mRender:(t,c,l,r)=>r.row+r.settings._iDisplayStart+1},{title:"NIM",data:"student_nim",name:"student_nim"},{title:"Nama",data:"student.name",name:"student.name"},{title:"Jenis Kelamin",data:"student_gender",name:"student_gender",mRender:function(t){return t=="L"?"Laki-Laki":"Perempuan"}},{title:"Ketua Kelas",data:"is_class_coordinator",name:"is_class_coordinator",mRender(t,c,l){return t?"Ketua Kelas":d("update-class-participants")?`<button class="btn btn-primary btn-sm set-coordinaotr" data-id="${l.id}">Set</button>`:""}},{title:"",data:"id",name:"id",searchable:!1,orderable:!1,sClass:"text-center nowrap",mRender:(t,c,l,r)=>{var m="";return v().includes("delete-class-participants")&&!l.college_class.feeder_id&&(m+=`<button type="button" class="btn btn-outline-danger btn-sm mx-1" data-toggle="delete" data-id="${t}"><i class="bx bx-trash"></i></button>`),m}}],callback:()=>{$('button[data-toggle="delete"]').unbind().on("click",function(t){t.preventDefault(),s($(this).data("id"))}),$(".set-coordinaotr").unbind().on("click",function(t){t.preventDefault(),a($(this).data("id"))})},options:{order:[2,"asc"]}});class h extends p{render(){return e("div",{className:"modal fade",id:"single-insert-modal",role:"dialog"},e("div",{className:"modal-dialog",role:"document"},e("div",{className:"modal-content"},e("form",{onsubmit:this.props.onsubmit},e("div",{className:"modal-header bg-light pb-2"},e("h5",{className:"modal-title"},this.props.title)),e("div",{className:"modal-body"},e("input",{type:"hidden",name:"input_type"}),e("input",{type:"hidden",name:"college_class_id",value:""}),e("div",{className:"mb-3"},e("label",{htmlFor:"student",className:"from-label"},"Mahasiswa  ",e("span",{className:"text-danger"},"*")),e("select",{name:"students",id:"student",className:"form-control js-choices"}))),e("div",{className:"modal-footer"},e("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),e("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},e("i",{className:"bx bx-save"})," Simpan"))))))}}n(h,"defaultProps",{onsubmit:null,title:"Untitled Modal",academicPeriods:[],studyProgramId:""});class k extends p{constructor(){super(...arguments);n(this,"base_url","lecture/college-class/"+this.$router.params.id+"/class-participants")}render(){return e("div",{className:"intro-y"},e(N,{id:this.$router.params.id}),e("div",{className:"card shadow-sm mb-3"},e("div",{className:"card-header border-0"},e("div",{className:"row"},e("div",{className:"text-sm-end text-center"},e("div",{className:"dt-actions d-inline"}),(d("create-class-participants")||this.isLecturerAllowedToInsert)&&!this.collegeClass.feeder_id?e("div",{class:"btn-group"},e("button",{type:"button",class:"btn btn-primary dropdown-toggle","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Tambah Peserta"),e("div",{class:"dropdown-menu"},e("a",{class:"dropdown-item",href:"#",onClick:a=>{a.preventDefault(),this.openSingleParticipantModal()}},"Satu Peserta"),e("router-link",{link:`/apps/lecture/college-class/schedule/${this.$router.params.id}/class-participant/batch-insert`,class:"dropdown-item"},"Banyak Peserta"))):""))),e("div",{className:"card-body"},e("div",{className:"table-responsive table-card mb-1"},e("table",{className:"table zero-configuration",width:"100%",id:"dataTable"})))),d("create-class-participants")?e(h,{title:"Tambah Satu Peserta",onsubmit:this.submitSingleParticipant}):"")}async componentWillMount(){const a=await o(`lecture/college-class/schedule/${this.$router.params.id}`,{hideSuccessNotification:!0});this.collegeClass=a.data.collegeClass,this.isLecturerAllowedToInsert=await this.checkLecturerEligibility()}async checkLecturerEligibility(){return(await o(`lecture/college-class/${this.$router.params.id}/class-participants/eligibility-check`,{hideSuccessNotification:!0})).data.isAllowed}componentDidMount(){this.table=w("#dataTable",x(this.$router.params.id,this.deleteData,this.setClassCoordinator));const a=$(".js-choices");a[0].choices.passedElement.element.addEventListener("search",async t=>{var c;if(a[0].choices.clearChoices(),t.detail.value.length>2){const{data:l}=await o(`${this.base_url}/single-search?name=${encodeURI(t.detail.value)}`,{hideSuccessNotification:!0,hideLoadingBar:!0});(c=l.students)!=null&&c.length&&(a[0].choices.clearChoices(),a[0].choices.setChoices(l.students.map(r=>({value:r.id,label:r.nim+" - "+r.name}))))}})}async deleteData(a){await y(`${this.base_url}/${a}`),this.table.ajax.reload()}async openSingleParticipantModal(){$(".js-choices")[0].choices.clearChoices(),$(".js-choices")[0].choices.setChoices([{value:"",label:"Pilih Mahasiswa"}]),$(".js-choices")[0].choices.setChoiceByValue(""),$("#single-insert-modal").modal("show")}async setClassCoordinator(a){await u(`${this.base_url}/${a}/set-coordinator`),this.table.ajax.reload()}async submitSingleParticipant(a){a.preventDefault(),$("input[name=college_class_id]").val(this.$router.params.id),(await u(`${this.base_url}`,a.target)).status==200&&this.table.ajax.reload()}}n(k,"defaultProps",{..._(["getData"]),table:null,isLecturerAllowedToInsert:!1,collegeClass:null});export{k as default};
