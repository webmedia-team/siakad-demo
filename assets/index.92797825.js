var N=Object.defineProperty;var _=(o,t,s)=>t in o?N(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s;var n=(o,t,s)=>(_(o,typeof t!="symbol"?t+"":t,s),s);import{A as v,a as d,C as f,c as e,g as r,r as x,h as k,p,S as j,d as T,u as y}from"./index.d57021e8.js";import{H as C}from"./header-component.8d40ee12.js";import{i as w}from"./datatable.4b22066f.js";import{B}from"./button.d257158a.js";/* empty css                 */import{m as P}from"./map-actions.609b7ae0.js";import"./jquery.4c77f39d.js";const D=(o,t,s)=>({url:`${v}/lecture/college-class/${o}/exam-schedules`,table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,id:"id",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender(a,i,l,m){return`
                    <div class="form-check">
                        <input class="form-check-input dt-checkbox" type="checkbox" value="${l.id}">
                    </div>`}},{title:"No",data:"id",name:"id",searchable:!1,orderable:!1,width:"5%",mRender(a,i,l,m){return m.row+m.settings._iDisplayStart+1}},{title:"Jenis Ujian",data:"meeting_type.name",name:"meeting_type.name"},{title:"Tanggal",data:"date",name:"date"},{title:"Waktu",data:"time",name:"time "},{title:"Jenis Ujian",data:"type",name:"type",mRender:function(a){return a.toUpperCase()}},{title:"Ruang / Lokasi",data:"location",name:"location"},{title:"Peserta",data:"participant_count",name:"participant_count"},{title:"Pengawas",data:"employee_id_1",name:"employee_id_1",mRender:function(a,i,l){if(l.employee_id_1!=null||l.employee_id_2!=null){let m="";return l.employee_id_1!=null&&(m+=`<li>${l.employee1.front_title==null?"":l.employee1.front_title} ${l.employee1.name} ${l.employee1.back_title==null?"":", "+l.employee1.back_title}</li>`),l.employee_id_2!=null&&(m+=`<li>${l.employee2.front_title==null?"":l.employee2.front_title} ${l.employee2.name} ${l.employee2.back_title==null?"":", "+l.employee2.back_title}</li>`),`<ol class="vstack gap-2 fs-13 mb-0">
                                    ${m}
                                </ol>`}else return"-"}},{title:"",data:"id",name:"id",searchable:!1,orderable:!1,sClass:"text-center nowrap",mRender:(a,i,l,m)=>{var c="";return l.college_class.feeder_id==null&&(d().includes("update-exam-schedules")&&(c+=`<button type="button" class="btn btn-outline-primary btn-sm mx-1" data-toggle="edit" data-id="${a}"><i class="bx bx-edit-alt"></i></button>`),d().includes("delete-exam-schedules")&&(c+=`<button type="button" class="btn btn-outline-danger btn-sm mx-1" data-toggle="delete" data-id="${a}"><i class="bx bx-trash"></i></button>`)),c}}],callback:()=>{$('button[data-toggle="edit"]').unbind().on("click",function(a){a.preventDefault(),t($(this).data("id"))}),$('button[data-toggle="delete"]').unbind().on("click",function(a){a.preventDefault(),s($(this).data("id"))})}});class g extends f{render(){return e("div",{className:"modal fade",id:"exam-schedule-modal",role:"dialog"},e("div",{className:"modal-dialog modal-lg",role:"document"},e("div",{className:"modal-content"},e("form",{onsubmit:this.props.onsubmit},e("div",{className:"modal-header bg-light pb-2"},e("h5",{className:"modal-title"},this.props.title)),e("div",{className:"modal-body"},e("div",{className:"row"},e("div",{className:"col-md-6"},e("div",{className:"mb-3"},e("label",{htmlFor:"meeting_type",className:"from-label"},"Jenis Ujian  ",e("span",{className:"text-danger"},"*")),e("select",{name:"meeting_type",id:"meeting_type",className:"form-control js-choices"},e("option",{value:""},"Pilih Jenis Ujian"),this.props.meetingTypes.map(t=>e("option",{value:t.id},t.name))))),e("div",{className:"col-md-6"},e("div",{className:"mb-3"},e("label",{for:"type"},"Metode Ujian ",e("span",{className:"text-danger"},"*")),e("select",{name:"type",id:"type",className:"form-control js-choices"},e("option",{value:""},"Pilih Metode Ujian"),e("option",{value:"online"},"Online"),e("option",{value:"offline"},"Offline"))))),e("div",{className:"row"},e("div",{className:"col-md-6"},e("label",{htmlFor:"room",className:"from-label"},"Ruangan  ",e("span",{className:"text-danger"},"*")),e("select",{name:"room",id:"room",className:"form-control js-choices"},e("option",{value:""},"Pilih Ruangan"),this.props.rooms.map(t=>e("option",{value:t.id},t.name," - ",t.location)))),e("div",{className:"col-md-6"},e("div",{className:"mb-3"},e("label",{for:"location"},"Lokasi "),e("input",{type:"text",name:"location",className:"form-control",placeholder:"Lokasi",autocomplete:"off",id:"location"})))),e("div",{className:"row"},e("div",{className:"col-md-6"},e("div",{className:"mb-3"},e("label",{htmlFor:"time_start",className:"from-label"},"Waktu Mulai  ",e("span",{className:"text-danger"},"*")),e("select",{name:"time_start",id:"time_start",className:"form-control js-choices"},e("option",{value:""},"Pilih Waktu Mulai"),this.props.times.map(t=>e("option",{value:t.time},t.time," - ",t.type=="morning"?"Siang":t.type=="afternoon"?"Sore":"Malam"))))),e("div",{className:"col-md-6"},e("div",{className:"mb-3"},e("label",{htmlFor:"time_end",className:"from-label"},"Waktu Akhir  ",e("span",{className:"text-danger"},"*")),e("select",{name:"time_end",id:"time_end",className:"form-control js-choices"},e("option",{value:""},"Pilih Waktu Akhir"),this.props.times.map(t=>e("option",{value:t.time},t.time," -  ",t.type=="morning"?"Siang":t.type=="afternoon"?"Sore":"Malam")))))),e("div",{className:"row"},e("div",{className:"col-md-6"},e("div",{className:"mb-3"},e("label",{htmlFor:"employee1",className:"from-label"},"Pengawas 1"),e("select",{name:"employee1",id:"employee1",className:"form-control js-choices"},e("option",{value:""},"Pilih Pengawas 1"),this.props.employees.map(t=>e("option",{value:t.id},t.front_title==null?"":t.front_title," ",t.name,t.back_title==null?"":", "+t.back_title))))),e("div",{className:"col-md-6"},e("div",{className:"mb-3"},e("label",{htmlFor:"employee2",className:"from-label"},"Pengawas 2"),e("select",{name:"employee2",id:"employee2",className:"form-control js-choices"},e("option",{value:""},"Pilih Pengawas 2"),this.props.employees.map(t=>e("option",{value:t.id},t.front_title==null?"":t.front_title," ",t.name,t.back_title==null?"":", "+t.back_title)))))),e("div",{className:"mb-3"},e("label",{for:"date"},"Tanggal ",e("span",{className:"text-danger"},"*")),e("input",{type:"text",name:"date",className:"form-control flatpickr-date",placeholder:"Tanggal",autocomplete:"off",id:"date"}))),e("div",{className:"modal-footer"},e("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),e("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},e("i",{className:"bx bx-save"})," Simpan"))))))}}n(g,"defaultProps",{onsubmit:null,title:"Untitled Modal",data:null,meetingTypes:[],employees:[],rooms:[],times:[]});const[S,u]=y("Tambah Jadwal Ujian"),[h,b]=y("");class M extends f{constructor(){super(...arguments);n(this,"base_url","lecture/college-class/"+this.$router.params.id+"/exam-schedules")}render(){return e("div",{className:"intro-y"},e(C,{id:this.$router.params.id}),e("div",{className:"card shadow-sm mb-3"},e("div",{className:"card-header border-0"},e("div",{className:"row"},e("div",{className:"text-sm-end text-center"},e("div",{className:"dt-actions d-inline"}),e(B,{data:{redirect:!1,onclick:this.createData,refresh:!0,create:this.collegeClass.feeder_id==null,permission:"create-exam-schedules",title:"Tambah Jadwal Ujian"}})))),e("div",{className:"card-body"},e("div",{className:"table-responsive table-card mb-1"},e("table",{className:"table zero-configuration",width:"100%",id:"dataTable"})))),e(g,{times:this.times,employees:this.employees,rooms:this.rooms,meetingTypes:this.meetingTypes,onsubmit:this.submit,title:S}))}componentDidMount(){this.table=w("#dataTable",D(this.$router.params.id,this.editData,this.deleteData))}async componentWillMount(){const{data:s}=await this.getData({model:["getTimeSlots","getRooms","getEmployees","getTimeSlots"]}),a=await r(`lecture/college-class/schedule/${this.$router.params.id}`,{hideSuccessNotification:!0});let i=await this.getMeetingTypes("is_exam=true");this.meetingTypes=i.data.meetingTypes,this.employees=s.getEmployees,this.times=s.getTimeSlots,this.rooms=s.getRooms,this.collegeClass=a.data.collegeClass}createData(){u("Tambah Jadwal Ujian"),b(""),x(),k(),$("#exam-schedule-modal").modal("show")}async editData(s){u("Edit Jadwal Ujian"),this.showLoading();const a=await r(`${this.base_url}/${s}`,{hideSuccessNotification:!0}),{examSchedule:i}=a.data;this.hideLoading(),a.status==200&&(b(i.id),$('*[name="date"]').val(i.date),$('*[name="location"]').val(i.location),$(".js-choices")[0].choices.setChoiceByValue(i.meeting_type_id.toString()),$(".js-choices")[1].choices.setChoiceByValue(i.type),$(".js-choices")[2].choices.setChoiceByValue(i.room_id),$(".js-choices")[3].choices.setChoiceByValue(i.time_start),$(".js-choices")[4].choices.setChoiceByValue(i.time_end),$(".js-choices")[5].choices.setChoiceByValue(i.employee_id_1),$(".js-choices")[6].choices.setChoiceByValue(i.employee_id_2)),$("#exam-schedule-modal").modal("show")}async submit(s){s.preventDefault();let a;h==""?a=await p(`${this.base_url}`,s.target):a=await p(`${this.base_url}/${h}`,s.target),a.status==200&&(this.$router.reload(),this.table.ajax.reload)}async deleteData(s){j.fire({title:"Hapus ?",icon:"question",text:"Data yang dihapus tidak dikembalikan!",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Ya, lanjutkan",cancelButtonText:"Batal",confirmButtonColor:"#d1403b"}).then(async a=>{a.isConfirmed&&(await T(`${this.base_url}/${s}`)).status==200&&this.table.ajax.reload()})}}n(M,"defaultProps",{...P(["getData","getMeetingTypes"]),meetingTypes:[],employees:[],rooms:[],times:[],collegeClass:[],table:null});export{M as default};
