var y=Object.defineProperty;var x=(n,i,t)=>i in n?y(n,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[i]=t;var c=(n,i,t)=>(x(n,typeof i!="symbol"?i+"":i,t),t);import{A as v,i as m,C as h,c as a,g as u,h as k,p,S as b,d as _,u as f}from"./index.d57021e8.js";import{H as w}from"./header-component.8d40ee12.js";import{i as N}from"./datatable.4b22066f.js";import"./jquery.4c77f39d.js";import{m as C}from"./map-actions.609b7ae0.js";/* empty css                 */const D=(n,i,t,l)=>({url:`${v}/lecture/college-class/${n}/class-schedules`,table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,id:"code",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender:(e,o,s,r)=>`
        <div class="form-check">
            <input class="form-check-input dt-checkbox" type="checkbox" value="${s.id}">
        </div>`},{title:"No",data:"id",name:"id",searchable:!1,orderable:!1,width:"5%",mRender:(e,o,s,r)=>r.row+r.settings._iDisplayStart+1},{title:"Pert.",data:"meeting_number",name:"meeting_number",defaultContent:"-"},{title:"Hari",data:"formatted_date",name:"formatted_date",defaultContent:"-"},{title:"Waktu",data:"formatted_time_range",name:"formatted_time_range",defaultContent:"-"},{title:"Ruang",data:"room.name",name:"room.name",defaultContent:"-",mRender(e,o,s){return`${e}${s.room.location?` - ${s.room.location}`:""}`}},{title:"Jenis",data:"meeting_type.name",name:"meeting_type.name",defaultContent:"-"},{title:"Pengajar",data:"employee.name",name:"employee.name",defaultContent:"-",mRender(e,o,s){return`${s.employee.front_title?`${s.employee.front_title}.`:""} ${e} ${s.employee.back_title?`, ${s.employee.back_title}`:""}`}},{title:"Status",data:"status",name:"status",defaultContent:"-",mRender(e){switch(e){case"schedule":return'<span class="badge badge-soft-primary">Terjadwal</span>';case"start":return'<span class="badge badge-soft-warning">Dimulai</span>';case"done":return'<span class="badge badge-soft-success">Selesai</span>';case"reschedule":return'<span class="badge badge-soft-secondary">Dijadwalkan Ulang</span>';default:return"-"}}},{title:"",data:"id",name:"id",searchable:!1,orderable:!1,sClass:"text-center nowrap",mRender:(e,o,s,r)=>{var d="";return s.college_class.feeder_id||(s.status!="done"&&s.status!="reschedule"&&(m("update-college-class-schedules")&&(d+=`<button type="button" class="btn btn-outline-primary btn-sm mx-1" data-toggle="edit" data-id="${e}"><i class="bx bx-pencil"></i></button>`),m("delete-college-class-schedules")&&(d+=`<button type="button" class="btn btn-outline-danger btn-sm mx-1" data-toggle="delete" data-id="${e}"><i class="bx bx-trash"></i></button>`)),s.status=="done"&&m("update-college-class-schedules")&&(d+=`<button type="button" class="btn btn-outline-primary btn-sm mx-1" data-toggle="realization" data-id="${e}"><i class="ri-file-edit-line"></i></button>`)),d}}],callback:()=>{$('button[data-toggle="delete"]').unbind().on("click",function(e){e.preventDefault(),i($(this).data("id"))}),$('button[data-toggle="edit"]').off("click").on("click",function(e){e.preventDefault(),t($(this).data("id"))}),$('button[data-toggle="realization"]').off("click").on("click",function(e){e.preventDefault(),l($(this).data("id"))})},options:{sort:[2,"asc"]}});class g extends h{render(){return a("div",{className:"modal fade",id:"realization-modal",role:"dialog"},a("div",{className:"modal-dialog",role:"document"},a("div",{className:"modal-content"},a("form",{onsubmit:this.props.onsubmit},a("div",{className:"modal-header bg-light pb-2"},a("h5",{className:"modal-title"},this.props.title)),a("div",{className:"modal-body"},a("div",{className:"mb-3"},a("label",{for:"name"},"Rencana Materi ",a("span",{className:"text-danger"},"*")),a("textarea",{name:"material_plan",id:"material_plan",className:"form-control",cols:"30",rows:"4"})),a("div",{className:"mb-3"},a("label",{for:"name"},"Realisasi Materi ",a("span",{className:"text-danger"},"*")),a("textarea",{name:"material_realization",className:"form-control",id:"material_realization",cols:"30",rows:"4"}))),a("div",{className:"modal-footer"},a("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),a("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},a("i",{className:"bx bx-save"})," Simpan"))))))}}c(g,"defaultProps",{onsubmit:null,title:"Untitled Modal",data:null});const[R,z]=f("Isi Realisasi Perkuliahan"),[S,T]=f("");class B extends h{constructor(){super(...arguments);c(this,"base_url","lecture/college-class/"+this.$router.params.id+"/class-schedules")}render(){return a("div",{className:"intro-y"},a(w,{id:this.$router.params.id}),a("div",{className:"card shadow-sm mb-3"},a("div",{className:"card-header border-0"},a("div",{className:"row"},a("div",{className:"text-sm-end text-center"},a("div",{className:"dt-actions d-inline"}),m("create-college-class-schedules")&&!this.collegeClass.feeder_id?a("div",{class:"btn-group"},a("button",{type:"button",class:"btn btn-primary dropdown-toggle","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Tambah Jadwal Perkuliahan"),a("div",{class:"dropdown-menu"},a("router-link",{link:`/apps/lecture/college-class/schedule/${this.$router.params.id}/class-schedule/create`,class:"dropdown-item",href:"#"},"Satu per Satu"),a("a",{class:"dropdown-item",href:"#",onClick:this.generateData},"Generate Data"))):""))),a("div",{className:"card-body"},a("div",{className:"table-responsive table-card mb-1"},a("table",{className:"table zero-configuration",width:"100%",id:"dataTable"})))),a(g,{onsubmit:this.submit,title:R}))}async componentWillMount(){const t=await u(`lecture/college-class/schedule/${this.$router.params.id}`,{hideSuccessNotification:!0});this.collegeClass=t.data.collegeClass}componentDidMount(){this.table=N("#dataTable",D(this.$router.params.id,this.deleteData,this.updateData,this.editRealization))}async editRealization(t){z("Isi Realisasi Perkuliahan"),k(),this.showLoading();const l=await u(`${this.base_url}/${t}`,{hideSuccessNotification:!0}),{classSchedule:e}=l.data;this.hideLoading(),l.status==200&&(T(e.id),$('*[name="material_plan"]').val(e.material_plan),$('*[name="material_realization"]').val(e.material_realization)),$("#realization-modal").modal("show")}async submit(t){t.preventDefault();let l;l=await p(`${this.base_url}/${S}/realization`,t.target),l.status==200&&(this.$router.reload(),this.table.ajax.reload)}async deleteData(t){const{isConfirmed:l}=await b.fire({title:"Hapus Jadwal Perkuliahan ?",text:"Data jadwal perkuliahan ini akan dihapus!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, lanjutkan",cancelButtonText:"Batal",confirmButtonColor:"#d1403b"});l&&(await _(`${this.base_url}/${t}`)).status==200&&this.table.ajax.reload()}updateData(t){this.$router.pushState(`/apps/lecture/college-class/schedule/${this.$router.params.id}/class-schedule/${t}/update`)}async generateData(t){t.preventDefault();const{isConfirmed:l}=await b.fire({title:"Generate Data ?",text:"Data hanya dapat di generate untuk kelas yang memiliki jadwal mingguan!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, lanjutkan",cancelButtonText:"Batal",confirmButtonColor:"#d1403b"});l&&(await p(`${this.base_url}/generate-data`)).status==200&&this.table.ajax.reload()}}c(B,"defaultProps",{...C(["getData"]),collegeClass:null,table:null});export{B as default};
