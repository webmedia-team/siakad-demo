var p=Object.defineProperty;var g=(r,a,s)=>a in r?p(r,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[a]=s;var h=(r,a,s)=>(g(r,typeof a!="symbol"?a+"":a,s),s);import{C as _,c as e,i as y,g as n,p as b}from"./index.d57021e8.js";import{m as v}from"./map-actions.609b7ae0.js";class N extends _{async componentWillMount(){const{status:a,data:s}=await this.getData({model:["academicPeriods","studyPrograms"],where:[{is_active:!0},{}]});a==200&&(this.academicPeriods=s.academicPeriods,this.studyPrograms=s.studyPrograms)}render(){var a,s;return e("div",{className:"intro-y"},e("div",{className:"row"},e("div",{className:"col-12"},e("div",{className:"page-title-box d-sm-flex align-items-center justify-content-between"},e("h4",{className:"mb-sm-0"},this.meta.title),e("div",{className:"page-title-right"},e("ol",{className:"breadcrumb"},e("li",{className:"breadcrumb-item"},e("router-name",{name:"apps.dashboard"},"Dashboard")),e("li",{className:"breadcrumb-item active"},"Perkuliahan"),e("li",{className:"breadcrumb-item active"},"Data kelas"),e("li",{className:"breadcrumb-item active"},this.meta.title)))))),e("div",{className:"card shadow-sm mb-3"},e("div",{className:"card-body"},e("div",{className:"row"},e("div",{className:"col-sm-6 col-12"},e("div",{className:"mb-3"},e("label",null,"Periode Akademik"),e("select",{className:"form-control js-choices",name:"academic_period_id",onChange:this.fetchCourses},e("option",{value:"",key:""},"Pilih"),(a=this.academicPeriods)==null?void 0:a.map(i=>e("option",{value:i.id},i.name))))),e("div",{className:"col-sm-6 col-12"},e("div",{className:"mb-3"},e("label",null,"Program Studi"),e("select",{className:"form-control js-choices",name:"study_program_id",onChange:this.fetchCourses},e("option",{value:"",key:""},"Pilih"),(s=this.studyPrograms)==null?void 0:s.map(i=>{var t,l;return e("option",{value:i.id},(l=(t=i.education_level)==null?void 0:t.code)!=null?l:""," - ",i.name)})))),e("div",{className:"col-sm-6 col-12"},e("div",{className:"mb-3"},e("label",null,"Mata Kuliah"),e("select",{className:"form-control js-choices",name:"course_id",onChange:this.fetchCollegeClasses},e("option",{value:"",key:""},"Mata Kuliah")))),e("div",{className:"col-sm-6 col-12"},e("div",{className:"mb-3"},e("label",null,"Kelas Kuliah"),e("select",{className:"form-control js-choices",name:"college_class_id",onChange:this.fetchData},e("option",{value:"",key:""},"Kelas Kuliah"))))))),e("div",{className:"card shadow-sm mb-3"},e("form",{onsubmit:this.submit},e("div",{className:"card-header border-0 text-end"},y("update-presences")?e("button",{className:"btn btn-primary d-none",type:"submit"},e("i",{className:"bx bx-save"})," Simpan"):""),e("div",{className:"card-body",id:"renderData",style:"min-height: 300px;"},e("div",{className:"text-center mb-4"},e("lord-icon",{src:"https://cdn.lordicon.com/msoeawqm.json",trigger:"loop",colors:"primary:#66a1ee,secondary:#3080e8",style:"width:150px;height:150px"}),e("h5",{className:"text-muted mb-0"},"Opps! tidak ada yang dapat ditampilkan."))))))}async fetchCourses(a){var t;let s=$('*[name="academic_period_id"]').val(),i=$('*[name="study_program_id"').val();if(s!=""&&s!=null&&i!=""&&i!=null){const{status:l,data:c}=await n(`lecture/presences/get-courses?study_program_id=${i}&academic_period_id=${s}`,{hideSuccessNotification:!0});if(l==200){$(".js-choices")[2].choices.clearChoices(),$(".js-choices")[2].choices.clearStore(),$(".js-choices")[2].choices.clearInput();let d=[];(t=c==null?void 0:c.courses)==null||t.forEach(o=>{d.push({value:o.id,label:o.code+" - "+o.name})}),$(".js-choices")[2].choices.setChoices(d)}}}async fetchCollegeClasses(){var t;let a=$('*[name="academic_period_id"]').val(),s=$('*[name="study_program_id"').val(),i=$('*[name="course_id"').val();if(a!=""&&a!=null&&s!=""&&s!=null&&i!=""&&i!=null){const{status:l,data:c}=await n(`lecture/presences/get-college-classes?study_program_id=${s}&academic_period_id=${a}&course_id=${i}`,{hideSuccessNotification:!0});if(l==200){$(".js-choices")[3].choices.clearChoices(),$(".js-choices")[3].choices.clearStore(),$(".js-choices")[3].choices.clearInput();let d=[];(t=c==null?void 0:c.collegeClasses)==null||t.forEach(o=>{var m,u;d.push({value:o.id,label:o.name+" | "+((u=(m=o==null?void 0:o.lecture_system)==null?void 0:m.name)!=null?u:"-")+" | Peserta "+o.class_participant_count+" Orang"})}),$(".js-choices")[3].choices.setChoices(d)}}}async fetchData(){let a=$('*[name="academic_period_id"]').val(),s=$('*[name="study_program_id"').val(),i=$('*[name="course_id"').val(),t=$('*[name="college_class_id"').val();if(a!=""&&a!=null&&s!=""&&s!=null&&i!=""&&i!=null&&t!=""&&t!=null){$("#renderData").attr("style","min-height: 300px"),$("#renderData").html(""),$("#renderData").waitMe({effect:"win8",bg:"rgba(255, 255, 255, .7)",color:"#6691e7",text:"Mengambil data..."});const{status:l,data:c}=await n(`lecture/presences/get-class-participant?study_program_id=${s}&academic_period_id=${a}&course_id=${i}&college_class_id=${t}`,{hideSuccessNotification:!0});$("#renderData").waitMe("hide"),l==200&&(console.log(c.collections.length),c.collections.length>0?($("#renderData").parent().find('button[type="submit"]').removeClass("d-none"),$("#renderData").parent().find('button[type="submit"]').show(),$("#renderData").removeAttr("style"),document.querySelector("#renderData").innerHTML="",document.querySelector("#renderData").appendChild(this.renderHTML(c.headers,c.collections))):($("#renderData").parent().find('button[type="submit"]').hide(),$("#renderData").attr("style","min-height: 300px"),$("#renderData").append(`
                        <div class="text-center mb-4">
                            <lord-icon
                                src="https://cdn.lordicon.com/msoeawqm.json"
                                trigger="loop"
                                colors="primary:#66a1ee,secondary:#3080e8"
                                style="width:150px;height:150px">
                            </lord-icon>
                            <h5 class="text-muted mb-0">Opps! tidak ada yang dapat ditampilkan.</h5>
                        </div>
                    `)))}}renderHTML(a,s){$('*[name="academic_period_id"]').val(),$('*[name="study_program_id"').val(),$('*[name="course_id"').val();let i=$('*[name="college_class_id"').val();return e("div",{className:"table-card table-responsive"},e("table",{className:"table zero-configuration table-bordered"},e("thead",{className:"bg-light"},e("tr",{key:""},e("th",{rowspan:"2",valign:"middle",width:"2%",className:"text-center"},"No."),e("th",{rowspan:"2",valign:"middle"},"Nama Mahasiswa"),e("th",{colspan:"16",className:"text-center"},"Perkuliahan Ke")),e("tr",{key:""},a.map(t=>e("th",{width:"60",className:"text-center"},t)))),e("tbody",null,e("input",{type:"hidden",name:"college_class_id",value:i}),s.map((t,l)=>e("tr",{key:""},e("input",{type:"hidden",name:"student_id[]",value:t.id}),e("input",{type:"hidden",name:"class_schedule_id[]",value:t.class_schedule_id}),e("td",null,parseInt(l)+1),e("td",{style:"white-space: nowrap"},t.name),a.map(c=>e("td",{width:"60",className:"text-center"},e("select",{name:`meeting_${c}[]`,className:"form-control text-center",disabled:t["meeting_of_"+c][0]},e("option",{value:"0",key:"",selected:t["meeting_of_"+c][1]==0},"-"),e("option",{value:"H",key:"",selected:t["meeting_of_"+c][1]=="H"},"H"),e("option",{value:"I",key:"",selected:t["meeting_of_"+c][1]=="I"},"I"),e("option",{value:"S",key:"",selected:t["meeting_of_"+c][1]=="S"},"S"),e("option",{value:"A",key:"",selected:t["meeting_of_"+c][1]=="A"},"A")))))))))}async submit(a){a.preventDefault(),this.showWaiting(),await b("lecture/presences/",a.target),this.hideWaiting()}}h(N,"defaultProps",{...v(["getData"]),studyPrograms:[],academicPeriods:null,courses:null,collegeClasses:null});export{N as default};
