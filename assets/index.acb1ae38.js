var w=Object.defineProperty;var k=(s,a,i)=>a in s?w(s,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[a]=i;var r=(s,a,i)=>(k(s,typeof a!="symbol"?a+"":a,i),i);import{A as P,a as v,C as h,c as e,r as m,h as u,g as A,p,S,d as T,u as y,B as C}from"./index.d57021e8.js";import{i as D}from"./datatable.4b22066f.js";import{B}from"./button.d257158a.js";import{m as j}from"./map-actions.609b7ae0.js";/* empty css                 */import"./jquery.4c77f39d.js";const M=(s,a,i)=>({url:P+"/lecture/activities",table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,id:"code",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender:(t,d,o,l)=>`
                  <div class="form-check">
                      <input class="form-check-input dt-checkbox" type="checkbox" value="${o.id}">
                  </div>`},{title:"No",data:"id",name:"id",searchable:!1,orderable:!1,width:"5%",mRender:(t,d,o,l)=>l.row+l.settings._iDisplayStart+1},{title:"Program Studi",data:"study_program",name:"study_program_id",mRender:t=>{var d,o,l;return`${(o=(d=t==null?void 0:t.education_level)==null?void 0:d.code)!=null?o:""} - ${(l=t==null?void 0:t.name)!=null?l:""}`}},{title:"Semester",data:"academic_period.name",name:"academic_period_id"},{title:"Jenis",data:"student_activity_category.name",name:"student_activity_category_id"},{title:"Judul",data:"name",name:"name"},{title:"Jumlah Anggota",data:"student_activity_member_count",name:"student_activity_member_count"},{title:"Nomor SK",data:"decree_number",name:"decree_number"},{title:"Tanggal SK",data:"decree_date",name:"decree_date"},{title:"MBKM?",data:"is_mbkm",name:"is_mbkm",defaultContent:"-",mRender:(t,d,o,l)=>`<i class="bx bxs-${t==!0?"check":"minus"}-circle text-${t==!0?"success":"danger"} bx-bold"></i>`},{title:"",data:"id",name:"id",searchable:!1,orderable:!1,sClass:"text-center nowrap",mRender:(t,d,o,l)=>{var c="";return c+=`<button type="button" class="btn btn-outline-warning btn-sm mx-1" data-toggle="detail" data-id="${t}"><i class="bx bx-menu"></i></button>`,o.feeder_id==null&&(v().includes("update-activities")&&(c+=`<button type="button" class="btn btn-outline-primary btn-sm mx-1" data-toggle="edit" data-id="${t}"><i class="bx bx-edit-alt"></i></button>`),v().includes("delete-activities")&&(c+=`<button type="button" class="btn btn-outline-danger btn-sm mx-1" data-toggle="delete" data-id="${t}"><i class="bx bx-trash"></i></button>`)),c}}],callback:()=>{$('button[data-toggle="edit"]').unbind().on("click",function(t){t.preventDefault(),s($(this).data("id"))}),$('button[data-toggle="delete"]').unbind().on("click",function(t){t.preventDefault(),a($(this).data("id"))}),$('button[data-toggle="detail"]').unbind().on("click",function(t){t.preventDefault(),i($(this).data("id"))})},options:{sort:[3,"desc"]}});class _ extends h{render(){return e("div",{className:"modal fade",id:"activity-modal",role:"dialog"},e("div",{className:"modal-dialog modal-lg",role:"document"},e("div",{className:"modal-content"},e("form",{onsubmit:this.props.onsubmit},e("div",{className:"modal-header bg-light pb-2"},e("h5",{className:"modal-title"},this.props.title)),e("div",{className:"modal-body"},e("div",{className:"row"},e("div",{className:"col-md-6"},e("div",{className:"mb-3"},e("label",{htmlFor:""},"Program Studi ",e("span",{className:"text-danger"},"*")),e("select",{name:"study_program",className:"form-control js-choices"},e("option",{value:""},"Pilih"),this.props.studyPrograms.map(a=>e("option",{value:a.id},a.education_level.code," - ",a.name))))),e("div",{className:"col-md-6"},e("div",{className:"mb-3"},e("label",{htmlFor:""},"Semester ",e("span",{className:"text-danger"},"*")),e("select",{name:"semester",className:"form-control js-choices"},e("option",{value:""},"Pilih"),this.props.activeAcademicPeriod.map(a=>e("option",{value:a.id},a.name)))))),e("div",{className:"mb-3"},e("div",{className:"row"},e("div",{className:"col-md-6"},e("label",{for:"decree_number"},"Nomor SK "),e("input",{type:"text",name:"decree_number",className:"form-control",placeholder:"Nomor SK",autocomplete:"off",id:"decree_number"})),e("div",{className:"col-md-6"},e("label",{for:"decree_date"},"Tanggal SK "),e("input",{type:"text",name:"decree_date",className:"form-control flatpickr-date",placeholder:"Tanggal SK",autocomplete:"off",id:"decree_date"})))),e("div",{className:"row"},e("div",{className:"col-md-6"},e("div",{className:"mb-3"},e("label",{htmlFor:""},"Kategori Aktivitas ",e("span",{className:"text-danger"},"*")),e("select",{name:"activity_category",className:"form-control js-choices"},e("option",{value:""},"Pilih"),this.props.activityCategories.map(a=>e("option",{value:a.id},a.name))))),e("div",{className:"col-md-6"},e("label",{htmlFor:""},"Jenis Anggota ",e("span",{className:"text-danger"},"*")),e("select",{name:"type",className:"form-control js-choices"},e("option",{value:""},"Pilih"),e("option",{value:"0"},"Personal"),e("option",{value:"1"},"Kelompok")))),e("div",{className:"mb-3"},e("label",{for:"title"},"Judul ",e("span",{className:"text-danger"},"*")),e("textarea",{name:"title",id:"title",className:"form-control",cols:"30",rows:"2"})),e("div",{className:"mb-3"},e("label",{for:"description"},"Keterangan"),e("textarea",{name:"description",id:"description",className:"form-control",cols:"30",rows:"2"})),e("div",{className:"mb-3"},e("label",{for:"location"},"Lokasi "),e("input",{type:"text",name:"location",className:"form-control",placeholder:"Lokasi",autocomplete:"off",id:"location"})),e("div",{className:"mb-3"},e("div",{className:"row"},e("div",{className:"col-md-6"},e("label",{for:"start_date"},"Tanggal Awal "),e("input",{type:"text",name:"start_date",className:"form-control flatpickr-date",placeholder:"Tanggal Awal",autocomplete:"off",id:"start_date"})),e("div",{className:"col-md-6"},e("label",{for:"end_date"},"Tanggal Akhir "),e("input",{type:"text",name:"end_date",className:"form-control flatpickr-date",placeholder:"Tanggal Akhir",autocomplete:"off",id:"end_date"})))),e("div",{className:"mb-3"},e("label",{htmlFor:""},"MBKM? ",e("span",{className:"text-danger"},"*")),e("select",{name:"mbkm",className:"form-control js-choices"},e("option",{value:""},"Pilih"),e("option",{value:"1"},"Ya"),e("option",{value:"0"},"Tidak")))),e("div",{className:"modal-footer"},e("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),e("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},e("i",{className:"bx bx-save"})," Simpan"))))))}}r(_,"defaultProps",{onsubmit:null,title:"Untitled Modal",data:null,activeAcademicPeriod:[],studyPrograms:[],activityCategories:[]});class x extends h{render(){return e("div",{className:"modal fade",id:"form-import",role:"dialog"},e("div",{className:"modal-dialog",role:"document"},e("div",{className:"modal-content"},e("form",{encType:"multipart/form-data",onSubmit:this.props.onsubmit},e("div",{className:"modal-header bg-light pb-2"},e("h5",{className:"modal-title"},this.props.title)),e("div",{className:"modal-body"},e("div",{className:"mb-3"},e("button",{type:"button",onClick:this.props.ondownload,className:"btn btn-sm btn-primary"},e("i",{className:"bx bx-receipt"})," Template")),e("div",{id:""},e("div",{className:"mb-3"},e("label",{for:"file",className:"form-label"},"File Import"),e("br",null),e("input",{type:"file",name:"file_import",id:"file_import",className:"filepond",required:!0}),e("code",{className:""},"excel")))),e("div",{className:"modal-footer"},e("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),e("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},e("i",{className:"bx bx-save"})," Simpan"))))))}}r(x,"defaultProps",{onsubmit:null,ondownload:null,title:"Untitled Modal"});const[g,b]=y("Tambah Aktivitas Mahasiswa"),[f,N]=y(""),n="lecture/activities";class V extends h{render(){var a,i;return e("div",{className:"intro-y"},e("div",{className:"row"},e("div",{className:"col-12"},e("div",{className:"page-title-box d-sm-flex align-items center justify-content-between"},e("h4",{className:"mb-sm-0"},(a=this.meta.title)!=null?a:"Untitled Page"),e("div",{className:"page-title-right"},e("div",{className:"breadcrumb"},e("li",{className:"breadcrumb-item"},e("router-link",{link:"apps.dashboard"},"Dashboard")),e("li",{className:"breadcrumb-item"},"Perkuliahan"),e("li",{className:"breadcrumb-item active"},(i=this.meta.title)!=null?i:"Untitled Page")))))),e("div",{className:"card dt-filter-card"},e("div",{className:"card-body"},e("div",{className:"row"},e("div",{className:"col-4"},e("label",{htmlFor:""},"Program Studi"),e("select",{name:"study_program_id",id:"study-program-id",className:"from-control js-choices dt-filter-input"},e("option",{value:""},"Pilih Prodi"),this.studyPrograms.map(t=>e("option",{value:t.id},t.education_level.code," - ",t.name)))),e("div",{className:"col-4"},e("label",{htmlFor:""},"Periode Akademik"),e("select",{name:"academic_period_id",className:"from-control js-choices dt-filter-input"},e("option",{value:""},"Pilih Tahun Akademik"),this.academicPeriods.map(t=>e("option",{value:t.id},t.name)))),e("div",{className:"col-4"},e("label",{htmlFor:""},"Jenis Aktivitas"),e("select",{name:"student_activity_category_id",className:"from-control js-choices dt-filter-input"},e("option",{value:""},"Pilih Jenis Aktivitas"),this.activityTypes.map(t=>e("option",{value:t.id},t.name))))))),e("div",{className:"card shadow-sm mb-3"},e("div",{className:"card-header border-0"},e("div",{className:"row"},e("div",{className:"text-sm-end text-center"},e("div",{className:"dt-actions d-inline"}),e(B,{data:{redirect:!1,onclick:this.createData,refresh:!0,filter:!0,permission:"create-activities",title:"Tambah Aktivitas Mahasiswa"}}),e("div",{className:"dropdown d-inline"},e("button",{className:"btn btn-warning dropdown-toggle","data-bs-toggle":"dropdown"},e("i",{className:"bx bx-cog"})," Aksi"),e("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1","data-popper-placement":"bottom-start",style:"position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate(0px, 40px);"},e("a",{class:"dropdown-item",href:"javascript: void(0)",onClick:()=>this.setImport("import")},"Import Aktivitas Mahasiswa")))))),e("div",{className:"card-body"},e("div",{className:"table-responsive table-card mb-1"},e("table",{className:"table zero-configuration",width:"100%",id:"dataTable"})))),e(_,{onsubmit:this.submit,title:g,activeAcademicPeriod:this.activeAcademicPeriod,studyPrograms:this.studyPrograms,activityCategories:this.activityTypes}),e(x,{title:g,onsubmit:this.submitSet,ondownload:this.downloadSet}))}componentDidMount(){this.table=D("#dataTable",M(this.editData,this.deleteData,this.detailData))}async componentWillMount(){const{data:a}=await this.getData({model:["studyPrograms","getStudentActivityCategories"]}),i=await this.getAcademicPeriods("is_use=true"),t=await this.getAcademicPeriods("is_active=true");this.studyPrograms=a.studyPrograms,this.academicPeriods=t.data.academicPeriods,this.activityTypes=a.getStudentActivityCategories.original.studentActivityCategories,this.activeAcademicPeriod=i.data.academicPeriods}createData(){b("Tambah Aktivitas Mahasiswa"),N(""),m(),u(),$("#activity-modal").modal("show")}async editData(a){b("Edit Aktivitas Mahasiswa"),m(),u(),this.showLoading();const i=await A(`${n}/${a}`,{hideSuccessNotification:!0}),{studentActivity:t}=i.data;this.hideLoading(),i.status==200&&(N(t.id),console.log(t),this.updateValue("title",t.name),this.updateValue("decree_number",t.decree_number),this.updateValue("decree_date",t.decree_date),this.updateValue("description",t.description),this.updateValue("location",t.location),this.updateValue("start_date",t.start_date),this.updateValue("end_date",t.end_date),$(".js-choices")[3].choices.setChoiceByValue(t.study_program_id.toString()),$(".js-choices")[4].choices.setChoiceByValue(t.academic_period_id.toString()),$(".js-choices")[5].choices.setChoiceByValue(t.student_activity_category_id.toString()),$(".js-choices")[6].choices.setChoiceByValue(t.type.toString()),$(".js-choices")[7].choices.setChoiceByValue(t.is_mbkm==!0?"1":"0"),$("#activity-modal").modal("show"))}async submit(a){a.preventDefault();let i;f==""?i=await p(`${n}`,a.target):i=await p(`${n}/${f}`,a.target),i.status==200&&(this.$router.reload(),this.table.ajax.reload())}async submitSet(a){a.preventDefault();let i;i=await p("lecture/activities/excel",a.target),console.log(a.target),i.status==200&&(this.$router.reload(),this.table.ajax.reload())}async downloadSet(a){a.preventDefault();const i=`${C}/api/v1/lecture/activities/download-template-import-data`,t=window.open(`${i}`,"_blank","resizable=yes,scrollbars=yes,status=yes");t&&(t.opener=null,t.location=`${i}`,t.addEventListener("beforeunload",function(){t.location=`${i}`}),setTimeout(function(){t.close()},4e3))}async deleteData(a){S.fire({title:"Hapus ?",icon:"question",text:"Data yang dihapus tidak dikembalikan!",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Ya, lanjutkan",cancelButtonText:"Batal",confirmButtonColor:"#d1403b"}).then(async i=>{i.isConfirmed&&(await T(`${n}/${a}`)).status==200&&this.table.ajax.reload()})}async detailData(a){this.$router.pushName("apps.lecture.activities.detail",{id:a})}setImport(){b("Import"),m(),u(),$("#form-import").modal("show")}}r(V,"defaultProps",{...j(["getStudyPrograms","getData","getAcademicPeriods"]),table:null,studyPrograms:[],academicPeriods:[],activityTypes:[],activeAcademicPeriod:null});export{V as default};
