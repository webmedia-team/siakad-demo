var b=Object.defineProperty;var N=(i,t,s)=>t in i?b(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var m=(i,t,s)=>(N(i,typeof t!="symbol"?t+"":t,s),s);import{C as v,c as e,g as u,B as _,u as o}from"./index.d57021e8.js";import{m as f}from"./map-actions.609b7ae0.js";const[l,y]=o(""),[c,P]=o(""),[n,k]=o(""),[p,S]=o(""),[h,x]=o("");class C extends v{async componentWillMount(){const t={model:["academicYears","academicPeriods","studyPrograms","getClassGroups"]},{status:s,data:a}=await this.getData(t);s==200&&(this.studyPrograms=a.studyPrograms,this.academicYears=a.academicYears,this.academicPeriods=a.academicPeriods)}render(){var t,s;return e("div",{class:"intro-y"},e("div",{className:"row"},e("div",{className:"col-12"},e("div",{className:"page-title-box d-sm-flex align-items-center justify-content-between"},e("h4",{class:"mb-sm-0"},(t=this.meta.title)!=null?t:"Untitled Page"),e("div",{className:"page-title-right"},e("div",{className:"breadcrumb"},e("li",{className:"breadcrumb-item"},e("router-link",{link:"apps.dashboard"},"Dashboard")),e("li",{className:"breadcrumb-item"},"Laporan"),e("li",{className:"breadcrumb-item"},"Mahasiswa"),e("li",{className:"breadcrumb-item active"},(s=this.meta.title)!=null?s:"Untitled Page")))))),e("div",{className:"card col-5",style:{marginLeft:440}},e("form",{onSubmit:this.handleSubmit},e("div",{className:"card-body"},e("div",{className:"mb-3"},e("label",{htmlFor:""},"Program Studi ",e("span",{className:"text-danger"},"*")),e("select",{name:"study_program_id",id:"study_program",className:"from-control js-choices dt-filter-input",onChange:a=>{k(a.target.value)}},e("option",{value:""},"Pilih"),this.studyPrograms.map(a=>e("option",{value:a.id,selected:a.id==n},a.education_level.code," - ",a.name)))),e("div",{className:"mb-3"},e("label",{htmlFor:""},"Angkatan ",e("span",{className:"text-danger"},"*")),e("select",{name:"study_program_id",id:"study_program",className:"from-control js-choices dt-filter-input",onChange:a=>{P(a.target.value),this.fetchClassGroup()}},e("option",{value:""},"Pilih"),this.academicYears.map(a=>e("option",{value:a.id,selected:a.id==c},a.name)))),e("div",{className:"mb-3"},e("label",{htmlFor:""},"Grup Kelas ",e("span",{className:"text-danger"},"*")),e("select",{name:"class_grup_id",id:"class_grup_id",className:"from-control js-choices dt-filter-input",onChange:a=>{y(a.target.value),this.fetchClassStudent()}},e("option",{value:""},"Pilih"),this.classGroup.map(a=>e("option",{value:a.hashid,selected:a.hashid==l},a.name)))),e("div",{className:"mb-3"},e("label",{htmlFor:""},"Mahasiswa ",e("span",{className:"text-danger"},"*")),e("select",{name:"student_id",required:!0,id:"student_id",className:"from-control js-choices dt-filter-input",onChange:a=>{x(a.target.value)}},e("option",{value:"",selected:!0},"Pilih Mahasiswa"),e("option",{value:"all"},"Semua Mahasiswa"),this.students.map(a=>e("option",{value:a.id,selected:a.id==h},a.name)))),e("div",{className:"mb-3"},e("label",{htmlFor:""},"Periode Akademik ",e("span",{className:"text-danger"},"*")),e("select",{name:"academic_period_id",id:"academic_period_id",className:"from-control js-choices dt-filter-input",onChange:a=>{S(a.target.value)}},e("option",{value:""},"Pilih"),this.academicPeriods.map(a=>e("option",{value:a.id,selected:a.hashid==p},a.name)))),e("div",{className:"row"},e("div",{className:"col-6 mb-3"},e("label",{htmlFor:""},"Penanda Tangan ",e("span",{className:"text-danger"},"*")),e("select",{name:"ttd",id:"ttd",className:"from-control js-choices dt-filter-input",required:!0},e("option",{value:""},"Pilih"),e("option",{value:"Direktur"},"Direktur"),e("option",{value:"Wadir1"},"Wadir 1"),e("option",{value:"Wadir2"},"Wadir 2"),e("option",{value:"Wadir3"},"Wadir 3"),e("option",{value:"Kejur"},"Ketua Jurusan"),e("option",{value:"Kepro"},"Ketua Prodi"))),e("div",{className:"col-6 mb-3"},e("label",{htmlFor:""},"Tampilkan Dosen Wali ",e("span",{className:"text-danger"},"*")),e("select",{name:"student_lecture",id:"student_lecture",className:"from-control js-choices dt-filter-input",required:!0},e("option",{value:""},"Pilih"),e("option",{value:"1"},"Iya"),e("option",{value:"0"},"Tidak")))),e("div",{className:"mb-3"},e("label",{htmlFor:""},"Nomor KHS ",e("span",{className:"text-danger"},"*")),e("input",{type:"text",className:"form-control",name:"khs_number",id:"khs_number",placeholder:"Nomor KHS",required:!0}),e("span",{className:"text-danger"},"Tambahkan **** untuk kode otomatis"))),e("div",{className:"card-footer text-end"},e("button",{className:"btn btn-primary",type:"submit","data-form-loading":!0},"Cetak")))))}async fetchClassStudent(){if(l=="all")$("#student_id").attr("disabled","true");else{$("#student_id").attr("disabled","false");const t=await u(`report/report-khs/get-student-class-group/${l}`),s=this;this.setState(()=>{s.students=t.data.students})}}async fetchClassGroup(){const t=await u(`report/report-khs/get-class-group/${c}/${n}`,{hideSuccessNotification:!0}),s=this;this.setState(()=>{s.classGroup=t.data.classGroups})}handleSubmit(t){t.preventDefault();let s=$("#ttd").val(),a=$("#student_lecture").val(),g=$("#khs_number").val();const d=`${_}/api/v1/report/report-khs/print?academic_period_id=${p}&academic_year_id=${c}&class_group_id=${l}&student=${h}&study_program_id=${n}&ttd=${s}&student_lecture=${a}&khs_number=${g}`,r=window.open(`${d}`,"_blank","resizable=yes,scrollbars=yes,status=yes");r&&(r.opener=null,r.location=`${d}`,r.addEventListener("beforeunload",function(){r.location=`${d}`}))}}m(C,"defaultProps",{...f(["getStudyPrograms","getAcademicYears","getClassGroups","getData","getStudents"]),table:null,studyPrograms:[],academicYears:[],academicPeriods:[],classGroup:[],students:[]});export{C as default};
