var x=Object.defineProperty;var m=(l,t,r)=>t in l?x(l,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[t]=r;var b=(l,t,r)=>(m(l,typeof t!="symbol"?t+"":t,r),r);import{C as N,c as a,g as c,B as g}from"./index.d57021e8.js";import{H as f}from"./header-component.e9afed59.js";import"./pdfmake.eff2433f.js";class w extends N{render(){var t,r;return a("div",{className:"intro-y"},a("div",{className:"row"},a("div",{className:"col-12"},a("div",{className:"page-title-box d-sm-flex align-items center justify-content-between"},a("h4",{className:"mb-sm-0"},(t=this.meta.title)!=null?t:"Untitled Page"),a("div",{className:"page-title-right"},a("div",{className:"breadcrumb"},a("li",{className:"breadcrumb-item"},a("router-link",{link:"apps.dashboard"},"Dashboard")),a("li",{className:"breadcrumb-item"},"Akademik"),a("li",{className:"breadcrumb-item active"},(r=this.meta.title)!=null?r:"Untitled Page")))))),a(f,null),a("div",{className:"card"},a("div",{className:"card-body"},a("div",{className:"row"},a("div",{className:"col-12"},a("label",{htmlFor:""},"Periode Akademik"),a("select",{name:"academic_period_id",id:"",className:"from-control js-choices dt-filter-input",onChange:this.fetchData},a("option",{value:""},"Pilih"),this.academicPeriods.map(n=>a("option",{value:n.id},n.name))))))),a("div",{className:"card"},a("div",{className:"card-header border-0"},a("div",{className:"text-sm-end text-center"},a("button",{className:"btn btn-primary d-none",type:"button",onClick:this.printPdf},a("i",{className:"bx bx-file"})," Cetak KHS"))),a("div",{className:"card-body",id:"render-data",style:{minHeight:"300px"}},a("div",{class:"col-lg-3 col-sm-6 col-8 mx-auto"},a("img",{src:"/assets/images/no-data.png",width:"100%",alt:""})),a("h5",{class:"text-center",style:"font-weight: bold"},"Cetak KHS belum diizinkan"),a("p",{class:"col-lg-6 col-sm-9 col-11 text-muted text-center mx-auto mb-5"},"Sabarlah wahai mahasiswa, jangan terburu-buru tunggu informasi lebih lanjut."))))}async componentWillMount(){const{status:t,data:r}=await c("student/general/student-semester",{hideSuccessNotification:!0});this.academicPeriods=r.academicPeriods}async fetchData(){var r;let t=$('select[name="academic_period_id"]').val();if(t!=""){$("#render-data").attr("style","min-height: 300px"),document.querySelector("#render-data").innerHTML="",$("#render-data").parent().find('button[type="button"]').addClass("d-none"),$("#render-data").parent().find('button[type="button"]').hide(),$("#render-data").attr("style"),$("#render-data").waitMe({effect:"win8",bg:"rgba(255, 255, 255, .7)",color:"#6691e7",text:"Mengambil data..."});const{status:n,data:s}=await c(`student/study-result/cards?academic_period_id=${t}`,{hideSuccessNotification:!0});$("#render-data").waitMe("hide"),n==200&&(((r=s==null?void 0:s.data.khs)==null?void 0:r.length)>0?(s.data.is_acc==!0?($("#render-data").parent().find('button[type="button"]').removeClass("d-none"),$("#render-data").parent().find('button[type="button"]').show(),$("#render-data").removeAttr("style")):($("#render-data").parent().find('button[type="button"]').addClass("d-none"),$("#render-data").parent().find('button[type="button"]').hide(),$("#render-data").attr("style")),document.querySelector("#render-data").innerHTML="",document.querySelector("#render-data").appendChild(this.renderHtml(s.data.khs,s.data.total_c,s.data.total_m)),this.khs=s.data.khs):($("#render-data").parent().find('button[type="button"]').hide(),$("#render-data").attr("style","min-height: 300px"),$("#render-data").append(`
                        <div class="col-lg-3 col-sm-6 col-8 mx-auto">
                            <img src="/assets/images/no-data.png" width="100%" alt="" />
                        </div>
                        <h5 class="text-center" style="font-weight: bold">Cetak KHS belum diizinkan</h5>
                        <p class="col-lg-6 col-sm-9 col-11 text-muted text-center mx-auto mb-5">
                            Sabarlah wahai mahasiswa, jangan terburu-buru tunggu informasi lebih lanjut.
                        </p>
                    `)))}}renderHtml(t,r,n){let s=0,d=0;return a("div",{className:"table-responsive table-card mb-1"},a("table",{className:"table table-bordered table-striped",width:"100%",id:""},a("thead",{className:"table-light"},a("tr",null,a("th",{className:"text-center",rowSpan:2},"No"),a("th",{className:"text-center",rowSpan:2},"Kode"),a("th",{className:"text-center",rowSpan:2},"Mata kuliah"),a("th",{className:"text-center",rowSpan:2},"HM"),a("th",{className:"text-center",rowSpan:2},"AM"),a("th",{className:"text-center",rowSpan:2},"K"),a("th",{className:"text-center",rowSpan:2},"M"))),a("tbody",null,t.map((e,h)=>{var o,i,u,p;return s=parseFloat(s)+parseFloat(parseFloat(e==null?void 0:e.index_score)*parseFloat(e==null?void 0:e.credit_total)),d=parseFloat(d)+parseFloat(e==null?void 0:e.credit_total),a("tr",null,a("td",{className:"text-center"},h+1),a("td",{className:"text-center"},(o=e==null?void 0:e.code)!=null?o:"-"),a("td",{className:"text-center"},(i=e==null?void 0:e.name)!=null?i:"-"),a("td",{className:"text-center"},(e==null?void 0:e.grade)!="0"&&(e==null?void 0:e.grade)!=null?e==null?void 0:e.grade:(u=e==null?void 0:e.final_grade)!=null?u:"E"),a("td",{className:"text-center"},(p=e==null?void 0:e.index_score)!=null?p:0),a("td",{className:"text-center"},e==null?void 0:e.credit_total),a("td",{className:"text-center"},parseFloat(e==null?void 0:e.index_score)*parseFloat(e==null?void 0:e.credit_total)%1>0?parseFloat(e==null?void 0:e.index_score)*parseFloat(e==null?void 0:e.credit_total):parseInt(parseFloat(e==null?void 0:e.index_score)*parseFloat(e==null?void 0:e.credit_total))))})),a("tfoot",{className:"table-light"},a("tr",null,a("td",{colSpan:3,className:"text-center"},"Jumlah"),a("td",null),a("td",null),a("td",{className:"text-center"},d),a("td",{className:"text-center"},parseFloat(s)%1>0?parseFloat(s):parseInt(s))),a("tr",null,a("td",{className:"text-center",colSpan:3},"IPS (Indeks Prestasi Semester)"),a("td",{className:"text-center",colSpan:4}," ",(parseFloat(s)/parseInt(d)).toFixed(2))),a("tr",null,a("td",{className:"text-center",colSpan:3},"IPK (Indeks Prestasi Kumulatif)"),a("td",{className:"text-center",colSpan:4},(n/r).toFixed(2))))))}async printPdf(){let{data:t,status:r}=await c("student/general/student-info",{hideSuccessNotification:!0}),n=t.data.id,s=$('select[name="academic_period_id"]').val();$('select[name="academic_period_id"]').text();const d=`${g}/api/v1/student/print/study-result/cards?student_id=${n}&academic_period_id=${s}`,e=window.open(`${d}`,"_blank","resizable=yes,scrollbars=yes,status=yes");e?(e.opener=null,e.location=`${d}`,e.addEventListener("beforeunload",function(){e.location=`${d}`})):console.log("Unable to open the new window")}}b(w,"defaultProps",{academicPeriods:[],table:null,scores:[]});export{w as default};
