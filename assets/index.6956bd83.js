var x=Object.defineProperty;var y=(n,s,t)=>s in n?x(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var r=(n,s,t)=>(y(n,typeof s!="symbol"?s+"":s,t),t);import{A as w,a as m,C as v,c as e,r as k,h as u,g as h,p,S as P,d as _,u as N}from"./index.d57021e8.js";import{m as D}from"./map-actions.609b7ae0.js";import{i as S}from"./datatable.4b22066f.js";import{B as R}from"./button.d257158a.js";/* empty css                 */import"./jquery.4c77f39d.js";const B=(n,s,t,i)=>({url:w+`/student-affair/scholarships/${t}/student-scholarship`,table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,name:"id",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender:(a,l,d,o)=>`
                    <div class="form-check">
                        <input class="form-check-input dt-checkbox" type="checkbox" value="${d.hashid}">
                    </div>`},{title:"No",data:null,name:null,searchable:!1,orderable:!1,width:"5%",mRender:(a,l,d,o)=>o.row+o.settings._iDisplayStart+1},{title:"Periode",data:"academic_period.name",name:"academic_period.name"},{title:"Mahasiswa",data:"student.name",name:"student.name",mRender:function(a,l,d){return d.student.nim+" - "+a}},{title:"Prodi",data:"student.study_program.name",name:"student.study_program.name",mRender:function(a,l,d){return d.student.study_program.education_level.code+" - "+a}},{title:"Nominal (Rp.)",data:"amount",name:"amount",mRender:function(a){return`Rp. ${Intl.NumberFormat("id").format(a)}`}},{title:"Keterangan",data:"description",name:"description",mRender:function(a){return a==null?"-":a}},{title:"Aktif",data:"is_active",name:"is_active",mRender:function(a,l,d){let o="";return o=`<div class="form-check form-switch form-switch-lg" dir="ltr">
                            <input type="checkbox" name="switch" class="form-check-input" id="${d.id}" data-id="${d.id}" ${a==!0?"checked":""}>
                            <label class="form-check-label" for="${d.id}"></label>
                        </div>`,o}},{title:"",data:"id",name:"id",searchable:!1,orderable:!1,sClass:"text-center nowrap",mRender:(a,l,d,o)=>{var c="";return m().includes("update-scholarships")&&(c+=`<button type="button" class="btn btn-outline-primary btn-sm mx-1" data-toggle="edit" data-id="${a}"><i class="bx bx-edit-alt"></i></button>`),m().includes("delete-scholarships")&&(c+=`<button type="button" class="btn btn-outline-danger btn-sm mx-1" data-toggle="delete" data-id="${a}"><i class="bx bx-trash"></i></button>`),c}}],callback:()=>{$('button[data-toggle="edit"]').unbind().on("click",function(a){a.preventDefault(),n($(this).data("id"))}),$('button[data-toggle="delete"]').unbind().on("click",function(a){a.preventDefault(),s($(this).data("id"))}),$('input[name="switch"]').unbind().on("change",function(a){a.preventDefault(),i($(this).data("id"))})}});class g extends v{render(){return e("div",{className:"modal fade",id:"student-scholarship-modal",role:"dialog"},e("div",{className:"modal-dialog modal-lg",role:"document"},e("div",{className:"modal-content"},e("form",{onsubmit:this.props.onsubmit},e("div",{className:"modal-header bg-light pb-2"},e("h5",{className:"modal-title"},this.props.title)),e("div",{className:"modal-body"},e("div",{className:"mb-3"},e("label",{for:"student"},"Mahasiswa ",e("span",{className:"text-danger"},"*")),e("select",{name:"student",id:"student",className:"form-control js-choices"},e("option",{value:""},"Pilih Mahasiswa"),this.props.students.map(s=>e("option",{value:s.id},s.nim," - ",s.name)))),e("div",{className:"row mb-3"},e("div",{className:"col-md-6"},e("label",{for:"academic-period"},"Periode Akademik ",e("span",{className:"text-danger"},"*")),e("select",{name:"academic_period",id:"academic-period",className:"form-control js-choices"},e("option",{value:""},"Pilih Periode Akademik"),this.props.academicPeriods.map(s=>e("option",{value:s.id},s.name)))),e("div",{className:"col-md-6"},e("label",{for:"amount"},"Nominal (Rp.) ",e("span",{className:"text-danger"},"*")),e("input",{type:"text",name:"amount",className:"form-control",placeholder:"Nominal (Rp.)",autocomplete:"off",id:"amount"}))),e("div",{className:"mb-3"},e("label",{for:"description"},"Keterangan "),e("input",{type:"text",name:"description",className:"form-control",placeholder:"Keterangan",autocomplete:"off",id:"description"}))),e("div",{className:"modal-footer"},e("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal"},"Batal"),e("button",{type:"submit",className:"btn btn-primary","data-form-loading":!0},e("i",{className:"bx bx-save"})," Simpan"))))))}}r(g,"defaultProps",{onsubmit:null,title:"Untitled Modal",data:null,academicPeriods:[],students:[]});const[A,b]=N("Tambah Penerima"),[f,T]=N("");class j extends v{constructor(){super(...arguments);r(this,"base_url",`student-affair/scholarships/${this.$router.params.id}/student-scholarship`)}render(){var t,i;return e("div",{className:"intro-y"},e("div",{className:"row"},e("div",{className:"col-12"},e("div",{className:"page-title-box d-sm-flex align-items-center justify-content-between"},e("h4",{className:"mb-sm-0"},(t=this.meta.title)!=null?t:"Untitled Page"),e("div",{className:"page-title-right"},e("ol",{className:"breadcrumb"},e("li",{className:"breadcrumb-item"},e("router-name",{name:"apps.dashboard"},"Dashboard")),e("li",{className:"breadcrumb-item"},"Kemahasiswaan"),e("li",{className:"breadcrumb-item"},"Beasiswa"),e("li",{className:"breadcrumb-item active"},(i=this.meta.title)!=null?i:"Untitled Page")))))),e("div",{className:"card dt-filter-card"},e("div",{className:"card-body"},e("div",{className:"row"},e("div",{className:"col-12"},e("label",{htmlFor:""},"Periode Akademik"),e("select",{name:"academic_period_id",id:"",className:"from-control js-choices dt-filter-input"},e("option",{value:""},"Pilih"),e("option",{value:"all"},"Semua Periode Akademik"),this.academicPeriods.map(a=>e("option",{value:a.id},a.name))))))),e("div",{className:"card"},e("div",{className:"card-header border-0"},e("div",{className:"text-sm-end text-center"},e("div",{className:"dt-actions d-inline"}),e(R,{data:{redirect:!1,onclick:this.createData,refresh:!0,filter:!0,permission:"create-scholarships",title:"Tambah Penerima"}}))),e("div",{className:"card-body"},e("div",{className:"table-responsive table-card mb-1"},e("table",{className:"table zero-configuration",width:"100%",id:"dataTable"})))),e(g,{onsubmit:this.submit,title:A,academicPeriods:this.academicPeriods,students:this.students}))}componentDidMount(){this.table=S("#dataTable",B(this.editData,this.deleteData,this.$router.params.id,this.updateStatus))}async componentWillMount(){const{data:t}=await this.getAcademicPeriods("is_active=true"),i=await this.getStudents("student_status_id=A");this.academicPeriods=t.academicPeriods,this.students=i.data.students}createData(){b("Tambah Penerima"),k(),u(),$("#student-scholarship-modal").modal("show")}async editData(t){b("Edit Penerima"),u(),this.showLoading();const i=await h(`${this.base_url}/${t}`,{hideSuccessNotification:!0}),{studentScholarship:a}=i.data;this.hideLoading(),i.status==200&&(T(a.id),$('*[name="amount"]').val(a.amount),$('*[name="description"]').val(a.description),$(".js-choices")[1].choices.setChoiceByValue(a.student_id.toString()),$(".js-choices")[2].choices.setChoiceByValue(a.academic_period_id.toString())),$("#student-scholarship-modal").modal("show")}async submit(t){t.preventDefault();let i;f==""?i=await p(`${this.base_url}`,t.target):i=await p(`${this.base_url}/${f}`,t.target),i.status==200&&(this.$router.reload(),this.table.ajax.reload)}async updateStatus(t){this.showLoading();const i=await h(`${this.base_url}/${t}/status`,{hideSuccessNotification:!1});this.hideLoading(),i.status==200&&this.table.ajax.reload()}async deleteData(t){P.fire({title:"Hapus ?",icon:"question",text:"Data yang dihapus tidak dikembalikan!",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Ya, lanjutkan",cancelButtonText:"Batal",confirmButtonColor:"#d1403b"}).then(async i=>{i.isConfirmed&&(await _(`${this.base_url}/${t}`)).status==200&&this.table.ajax.reload()})}}r(j,"defaultProps",{...D(["getData","getStudents","getAcademicPeriods"]),table:null,academicPeriods:[],students:[]});export{j as default};
