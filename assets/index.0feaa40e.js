var n=Object.defineProperty;var m=(r,e,t)=>e in r?n(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var o=(r,e,t)=>(m(r,typeof e!="symbol"?e+"":e,t),t);import{A as u,C as p,c as a,p as s,S as c}from"./index.d57021e8.js";import{i as f}from"./datatable.4b22066f.js";import{B as h}from"./button.d257158a.js";import{m as b}from"./map-actions.609b7ae0.js";import"./jquery.4c77f39d.js";const v=()=>({url:`${u}/feeder/curriculum`,table:[{title:'<div class="form-check"><input class="form-check-input" type="checkbox" id="dt-checkbox" /></div>',data:null,name:"id",searchable:!1,orderable:!1,width:"5%",sClass:"text-center",mRender:(r,e,t,i)=>`
                    <div class="form-check">
                        <input class="form-check-input dt-checkbox" type="checkbox" value="${t.id}">
                    </div>`},{title:"No",data:"id",name:"id",searchable:!1,orderable:!1,width:"5%",mRender:(r,e,t,i)=>i.row+i.settings._iDisplayStart+1},{title:"Nama Kurikulum",data:"name",name:"name"},{title:"Program Studi",data:"study_program",name:"studyProgram",defaultContent:"-",mRender(r,e,t){return r.education_level.code+" - "+r.name}},{title:"Mulai Berlaku",data:"academic_period.name",name:"academicPeriod",defaultContent:"-"},{title:"SKS Lulus",data:"credit_total",name:"credit_total",defaultContent:"-"},{title:"SKS Wajib",data:"mandatory_credit",name:"mandatory_credit",defaultContent:"-"},{title:"SKS Pilihan",data:"choice_credit",name:"choice_credit",defaultContent:"-"},{title:"Status",data:"feeder_id",name:"feeder_id",mRender:(r,e,t,i)=>{let d=`<span class="badge p-1 badge-soft-${r!=null?"success":"warning"} text-uppercase">
                        <i class="${r!=null?"ri-checkbox-circle-fill":"ri-alert-fill"} me-1 align-middle fs-16"></i>
                        ${r!=null?"Sudah Sync":"Belum Sync"}
                    </span>`;return t.feeder_description!=null&&(d+=`<br>
                            <span class="badge p-1 badge-soft-danger mt-2">
                                <i class="ri-error-warning-fill me-1 align-middle fs-16"></i>
                                ${t.feeder_description}
                            </span>
                        `),d}}],callback:()=>{}}),l="feeder/curriculum/sync";class g extends p{render(){return a("div",{className:"intro-y"},a("div",{className:"page-title-box d-sm-flex align-items-center justify-content-between"},a("h4",{className:"mb-sm-0"},this.meta.title)),a("div",{className:"card dt-filter-card"},a("div",{className:"card-body"},a("div",{className:"row"},a("div",{className:"col-4"},a("label",{htmlFor:""},"Program Studi"),a("select",{name:"study_program_id",id:"study-program-id",className:"from-control js-choices dt-filter-input"},a("option",{value:""},"Pilih Prodi"),this.studyPrograms.map(e=>a("option",{value:e.id},e.education_level.code," - ",e.name)))),a("div",{className:"col-4"},a("label",{htmlFor:""},"Periode Akademik"),a("select",{name:"academic_period_id",id:"academic-period-id",className:"from-control js-choices dt-filter-input"},a("option",{value:""},"Pilih Tahun Akademik"),this.academicPeriods.map(e=>a("option",{value:e.id},e.name)))),a("div",{className:"col-4"},a("label",{htmlFor:""},"Sync"),a("select",{name:"sync",id:"sync",className:"from-control js-choices dt-filter-input"},a("option",{value:"all",selected:!0},"Semua"),a("option",{value:"0"},"Sudah Sync"),a("option",{value:"1"},"Belum Sync")))))),a("div",{className:"card shadow-sm mb-3"},a("div",{className:"card-header border-0"},a("div",{className:"row"},a("div",{className:"text-sm-end text-center"},a("div",{className:"dt-actions d-inline"}),a(h,{data:{refresh:!0,create:!1,filter:!0}}),a("div",{className:"dropdown d-inline"},a("button",{className:"btn btn-primary dropdown-toggle","data-bs-toggle":"dropdown"},a("i",{className:"bx bx-sync"})," Sync Feeder"),a("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1","data-popper-placement":"bottom-start",style:"position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate(0px, 40px);"},a("a",{class:"dropdown-item",href:"#",onClick:this.downloadData},a("i",{className:"bx bx-download"})," Tarik Data Feeder"),a("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:this.uploadData},a("i",{className:"bx bx-upload"})," Upload Data"),a("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:this.updateData},a("i",{className:"bx bx-refresh"})," Update Data"),a("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:this.deleteData},a("i",{className:"bx bx-trash"})," Delete Data")))))),a("div",{className:"card-body"},a("div",{className:"table-responsive table-card mb-1"},a("table",{className:"table zero-configuration",width:"100%",id:"dataTable"})))))}componentDidMount(){this.table=f("#dataTable",v())}async componentWillMount(){const{data:e}=await this.getData({model:["studyPrograms"]}),t=await this.getAcademicPeriods("is_active=true");this.studyPrograms=e.studyPrograms,this.academicPeriods=t.data.academicPeriods}async downloadData(){let e,t=new FormData;t.append("act","getCurriculum"),e=await s(`${l}`,t,{},!1),e.status==200&&(this.$router.reload(),this.table.ajax.reload)}async uploadData(){var e=window.checkedDataIds;let t;if($(".dt-checkbox:checked").length<1){let i=new FormData;i.append("act","uploadCurriculum"),i.append("study_program_id",$("#study-program-id").val()),i.append("academic_period_id",$("#academic-period-id").val()),i.append("sync",$("#sync").val()),t=await s(`${l}`,i,{},!1)}else{let i=new FormData;i.append("act","uploadCurriculum");for(const d of e)i.append("curriculum[]",d);t=await s(`${l}`,i,{},!1)}t.status==200&&(this.$router.reload(),this.table.ajax.reload)}async updateData(){var e=window.checkedDataIds;let t;var i=new FormData;if(i.append("act","UpdateCurriculum"),$(".dt-checkbox:checked").length<1)c.fire({title:"Update Feeder gagal!",text:"Anda harus memilih Kurikulum",icon:"error",confirmButtonColor:"#d1403b"});else{for(const d of e)i.append("curriculum[]",d);t=await s(`${l}`,i,{},!1),t.status==200&&(this.$router.reload(),this.table.ajax.reload)}}async deleteData(){var e=window.checkedDataIds;let t;var i=new FormData;if(i.append("act","DeleteCurriculum"),$(".dt-checkbox:checked").length<1)c.fire({title:"Delete Feeder gagal!",text:"Anda harus memilih Kurikulum",icon:"error",confirmButtonColor:"#d1403b"});else{for(const d of e)i.append("curriculum[]",d);t=await s(`${l}`,i,{},!1),t.status==200&&(this.$router.reload(),this.table.ajax.reload)}}}o(g,"defaultProps",{...b(["getStudyPrograms","getData","getAcademicPeriods"]),table:null,studyPrograms:[],academicPeriods:[]});export{g as default};
